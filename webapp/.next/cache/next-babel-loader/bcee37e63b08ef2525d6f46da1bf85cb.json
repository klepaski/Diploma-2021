{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport Router, { useRouter } from 'next/router';\nimport { Wrapper, WrapperHeight } from \"../../../components/StyledComponents/Wrapper\";\nimport { Footer } from \"../../../components/Layouts/styledLayouts\";\nimport { Button } from \"../../../components/controls/Button/Button\";\nimport Upload from '../../../components/Offer/photos/Upload';\nimport Photos from '../../../components/Offer/photos/Photos';\nimport EditPhoto from '../../../components/Photo/EditPhoto';\nimport CoverPhoto from '../../../components/Offer/photos/CoverPhoto';\nimport Video from '../../../components/Offer/photos/Video';\nimport Header from \"../../../components/Header/Header\";\nimport { apiEditOffer, apiOfferPhotos, apiSetOfferCoverPhoto, apiRemoveOfferPhoto, apiEditOfferPhoto } from '../../../actions/api';\nimport withOfferInfo from \"../../../utils/offer\";\nimport { showNotification } from \"../../../utils/notification\";\nimport useOffer from \"../../../hooks/useOffer\";\nimport '../../../components/Offer/photos/photo.css';\nimport { MainContext } from \"../../../components/contextProviders/MainContext\";\nimport { ContainerDesktop, FooterDesktop } from \"../../../components/StyledComponents/Grid\";\nimport styled from \"styled-components\";\nimport { device } from \"../../../lib/mediaDevice\";\n\nconst PhotosPage = ({}) => {\n  const router = useRouter();\n  const {\n    id\n  } = router.query;\n  const offer = useOffer(id);\n  const {\n    setOffer\n  } = useContext(MainContext);\n  const {\n    0: step,\n    1: setStep\n  } = useState(0);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: loadingEdit,\n    1: setLoadingEdit\n  } = useState(false);\n  const {\n    0: uploading,\n    1: setUploading\n  } = useState(false);\n  const {\n    0: photos,\n    1: setPhotos\n  } = useState([]);\n  const {\n    0: videos,\n    1: setVideos\n  } = useState(['']);\n  const {\n    0: cover,\n    1: setCover\n  } = useState(null);\n  const {\n    0: photoEditable,\n    1: setPhotoEditable\n  } = useState({});\n  const {\n    0: keyPhoto,\n    1: setKeyPhoto\n  } = useState(null);\n  useEffect(() => {\n    if (offer.videoUrl && offer.videoUrl.length) {\n      setVideos(offer.videoUrl);\n    }\n\n    if (offer.offerPhoto && offer.offerPhoto.length) {\n      setPhotos(offer.offerPhoto);\n      setAvatarId();\n      setStep(2);\n    } else {\n      setStep(1);\n    }\n  }, [offer.id]);\n\n  const setAvatarId = () => {\n    if (!offer.avatarUrl) {\n      setCover(offer.offerPhoto[0].id);\n    } else {\n      let avatar = offer.offerPhoto.find(item => item.photoUrl === offer.avatarUrl);\n\n      if (avatar && avatar.id) {\n        setCover(avatar.id);\n      }\n    }\n  };\n\n  const onDrop = files => {\n    // setPhotos([...photos, ...files])\n    // setStep(2)\n    onUploadFiles(files);\n  };\n\n  const onUploadFiles = async files => {\n    let data = new FormData();\n    data.append(\"offerId\", id);\n    files.forEach(file => {\n      if (!file.id || file.blob) {\n        if (file.blob) {\n          data.append(\"file\", file.blob, file.name);\n        } else {\n          data.append(\"file\", file, file.name);\n        }\n      }\n    });\n    setUploading(true);\n    let res = await apiOfferPhotos(data);\n\n    if (res.data) {\n      setPhotos([...photos, ...res.data]);\n      if (res.data[0]) setCover(res.data[0].id);\n    }\n\n    setUploading(false);\n    setStep(2);\n  };\n\n  const onSetCover = id => {\n    setCover(id);\n    setStep(2);\n  };\n\n  const handleChangeStep = i => {\n    if (step === 5 && i === -1) {\n      setStep(2);\n      return;\n    }\n\n    if ((step === 1 || step === 2) && i === -1) {\n      Router.push('/offers/[id]/params', `/offers/${id}/params`, {\n        shallow: true\n      });\n    } else {\n      setStep(step + i);\n    }\n  };\n\n  const handleSave = async () => {\n    if (step == 1) {\n      apiEditOffer(id, {\n        step: 2\n      });\n      Router.push('/offers/[id]/regulations', `/offers/${id}/regulations`, {\n        shallow: true\n      });\n    }\n\n    if (step == 2) {\n      let data = new FormData();\n      data.append(\"offerId\", id);\n      photos.forEach(file => {\n        if (!file.id || file.blob) {\n          if (file.blob) {\n            data.append(\"file\", file.blob, file.name);\n          } else {\n            data.append(\"file\", file, file.name);\n          }\n        }\n      });\n      handleSendPhotos(data); // let photosDeleting = photos.filter((item, key) => (item.blob && item.id))\n      // if(photosDeleting.length) {\n      //     Promise.all(photosDeleting.map(item => handleRemovePhoto(item.id)))\n      //         .then(res => {\n      //             handleSendPhotos(data)\n      //         })\n      // } else {\n      //     handleSendPhotos(data)\n      // }\n    } else if (step == 5) {\n      let filterV = videos.filter(item => !!item);\n      const res = await apiEditOffer(id, {\n        step: 2,\n        videoUrl: filterV\n      });\n      setOffer(_objectSpread({}, offer, {\n        videoUrl: res.data.videoUrl\n      }));\n      Router.push('/offers/[id]/regulations', `/offers/${id}/regulations`, {\n        shallow: true\n      });\n    }\n  };\n\n  const handleSendPhotos = data => {\n    //TODO optimaze and don't send if something not changed\n    setLoading(true);\n    apiSetOfferCoverPhoto(id, {\n      offerPhotoId: cover\n    }).then(res => {\n      debugger;\n      setOffer(_objectSpread({}, offer, {\n        avatarUrl: res.data.avatarUrl\n      }));\n    });\n    let photosWithDesc = photos.filter(item => item.description);\n\n    _Promise.all(photosWithDesc.map(item => handleEditPhoto(item))).then(res => {\n      console.log('res', res);\n    });\n\n    apiOfferPhotos(data).then(res => {\n      setLoading(false);\n      let photosFilter = photos.filter(item => {\n        return item.id && !item.blob;\n      });\n      setPhotos([...photosFilter, ...res.data]);\n      setOffer(_objectSpread({}, offer, {\n        offerPhoto: [...photosFilter, ...res.data]\n      }));\n      setStep(5);\n    }).catch(e => {\n      showNotification('error', e);\n      setLoading(false);\n    });\n  };\n\n  const handleEditPhoto = async photo => {\n    const res = await apiEditOfferPhoto(photo);\n    console.log(res);\n    return res;\n  };\n\n  const handleRemovePhoto = async id => {\n    const res = await apiRemoveOfferPhoto(id);\n    console.log(res);\n    return res;\n  };\n\n  const handleDeletePhoto = async key => {\n    let photoByKey = photos[key];\n\n    if (photoByKey.id) {\n      const res = await handleRemovePhoto(photoByKey.id);\n      let photosClone = [...photos];\n      photosClone.splice(key, 1);\n      setPhotos(photosClone);\n      setStep(2);\n    } else {\n      let photosClone = [...photos];\n      photosClone.splice(key, 1);\n      setPhotos(photosClone);\n      setStep(2);\n    }\n  };\n\n  const setEditablePhoto = (photo, key) => {\n    setPhotoEditable(photo);\n    setKeyPhoto(key);\n    setStep(4);\n  };\n\n  const handleBackFromEdit = () => {\n    setPhotoEditable({});\n    setKeyPhoto(null);\n    setStep(2);\n  };\n\n  const handleRotate = async (blob, url, key) => {\n    try {\n      let photosCopy = [...photos],\n          ephoto = photosCopy[key],\n          isCover = !!(cover == ephoto.id);\n      setLoadingEdit(true);\n      let data = new FormData();\n      data.append(\"offerId\", offer.id);\n      data.append(\"file\", blob, 'blob file');\n      let res = await apiOfferPhotos(data);\n\n      if (ephoto && ephoto.id) {\n        await handleRemovePhoto(ephoto.id);\n      }\n\n      if (isCover) {\n        setCover(res.data[0].id);\n      }\n\n      photosCopy[key] = res.data[0];\n      setPhotos(photosCopy);\n      setLoadingEdit(false);\n      setStep(2);\n    } catch (e) {\n      showNotification('error', e);\n      setLoadingEdit(false);\n    }\n  };\n\n  const onChangePhotoDescription = (id, value) => {\n    value = value.slice(0, 100);\n    let photosClone = [...photos];\n    let key = photosClone.findIndex(item => item.id === id);\n    photosClone[key].description = value;\n    setPhotos(photosClone);\n    console.log(key, value);\n  };\n\n  const disabled = loading;\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isReg: true\n  }), __jsx(Wrapper, {\n    p: 17,\n    pt: 35\n  }, offer.id ? __jsx(React.Fragment, null, __jsx(ContainerDesktop, {\n    isOffer: true\n  }, __jsx(WrapperHeight, null, uploading && __jsx(\"div\", {\n    className: \"photo-uploading-router\"\n  }, \" Uploading... \"), step === 1 && __jsx(Upload, {\n    onDrop: onDrop\n  }), step === 2 && __jsx(Photos, {\n    onDrop: onDrop,\n    setStep: setStep,\n    cover: cover,\n    photos: photos,\n    setEditablePhoto: setEditablePhoto,\n    isHiddenDeleting: true\n  }), step === 3 && __jsx(CoverPhoto, {\n    photos: photos,\n    setCover: onSetCover,\n    handleBack: handleBackFromEdit,\n    cover: cover\n  }), step === 4 && __jsx(EditPhoto, {\n    keyPhoto: keyPhoto,\n    photo: photoEditable,\n    handleBack: handleBackFromEdit,\n    handleRotate: handleRotate,\n    handleDelete: handleDeletePhoto,\n    onChangePhotoDescription: onChangePhotoDescription,\n    loadingEdit: loadingEdit\n  }), step === 5 && __jsx(Video, {\n    videos: videos,\n    setVideos: videos => setVideos([...videos])\n  }))), step !== 3 && step !== 4 && __jsx(FooterDesktop, null, __jsx(Footer, {\n    pt: 30\n  }, __jsx(Button, {\n    onClick: () => handleChangeStep(-1)\n  }, \"Back\"), __jsx(Button, {\n    blue: true,\n    onClick: () => handleSave(),\n    loading: loading\n  }, step === 1 ? 'Skip' : 'Next')))) : __jsx(React.Fragment, null, \"Loading...\")));\n};\n\nexport default PhotosPage;","map":{"version":3,"sources":["D:/4/диплом/webapp — копия/pages/offers/[id]/photos.js"],"names":["React","useState","useContext","useEffect","Router","useRouter","Wrapper","WrapperHeight","Footer","Button","Upload","Photos","EditPhoto","CoverPhoto","Video","Header","apiEditOffer","apiOfferPhotos","apiSetOfferCoverPhoto","apiRemoveOfferPhoto","apiEditOfferPhoto","withOfferInfo","showNotification","useOffer","MainContext","ContainerDesktop","FooterDesktop","styled","device","PhotosPage","router","id","query","offer","setOffer","step","setStep","loading","setLoading","loadingEdit","setLoadingEdit","uploading","setUploading","photos","setPhotos","videos","setVideos","cover","setCover","photoEditable","setPhotoEditable","keyPhoto","setKeyPhoto","videoUrl","length","offerPhoto","setAvatarId","avatarUrl","avatar","find","item","photoUrl","onDrop","files","onUploadFiles","data","FormData","append","forEach","file","blob","name","res","onSetCover","handleChangeStep","i","push","shallow","handleSave","handleSendPhotos","filterV","filter","offerPhotoId","then","photosWithDesc","description","all","map","handleEditPhoto","console","log","photosFilter","catch","e","photo","handleRemovePhoto","handleDeletePhoto","key","photoByKey","photosClone","splice","setEditablePhoto","handleBackFromEdit","handleRotate","url","photosCopy","ephoto","isCover","onChangePhotoDescription","value","slice","findIndex","disabled"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\r\nimport Router, { useRouter } from 'next/router'\r\n\r\nimport {Wrapper, WrapperHeight} from \"../../../components/StyledComponents/Wrapper\";\r\nimport {Footer} from \"../../../components/Layouts/styledLayouts\";\r\nimport {Button} from \"../../../components/controls/Button/Button\";\r\nimport Upload from '../../../components/Offer/photos/Upload'\r\nimport Photos from '../../../components/Offer/photos/Photos'\r\nimport EditPhoto from '../../../components/Photo/EditPhoto'\r\nimport CoverPhoto from '../../../components/Offer/photos/CoverPhoto'\r\nimport Video from '../../../components/Offer/photos/Video'\r\nimport Header from \"../../../components/Header/Header\";\r\n\r\nimport {apiEditOffer, apiOfferPhotos, apiSetOfferCoverPhoto, apiRemoveOfferPhoto, apiEditOfferPhoto} from '../../../actions/api'\r\nimport withOfferInfo from \"../../../utils/offer\";\r\nimport {showNotification} from \"../../../utils/notification\";\r\nimport useOffer from \"../../../hooks/useOffer\"\r\n\r\nimport '../../../components/Offer/photos/photo.css'\r\nimport {MainContext} from \"../../../components/contextProviders/MainContext\";\r\nimport {ContainerDesktop, FooterDesktop} from \"../../../components/StyledComponents/Grid\";\r\nimport styled from \"styled-components\";\r\nimport {device} from \"../../../lib/mediaDevice\";\r\n\r\nconst PhotosPage = ({}) => {\r\n    const router = useRouter()\r\n    const {id} = router.query\r\n    const offer = useOffer(id)\r\n    const {setOffer} = useContext(MainContext)\r\n    const [step, setStep] = useState(0)\r\n    const [loading, setLoading] = useState(false)\r\n    const [loadingEdit, setLoadingEdit] = useState(false)\r\n    const [uploading, setUploading] = useState(false)\r\n    const [photos, setPhotos] = useState([])\r\n    const [videos, setVideos] = useState([''])\r\n    const [cover, setCover] = useState(null)\r\n    const [photoEditable, setPhotoEditable] = useState({})\r\n    const [keyPhoto, setKeyPhoto] = useState(null)\r\n\r\n    useEffect(() => {\r\n        if(offer.videoUrl && offer.videoUrl.length) {\r\n            setVideos(offer.videoUrl)\r\n        }\r\n        if(offer.offerPhoto && offer.offerPhoto.length) {\r\n            setPhotos(offer.offerPhoto)\r\n            setAvatarId()\r\n            setStep(2)\r\n        } else {\r\n            setStep(1)\r\n        }\r\n    }, [offer.id])\r\n\r\n    const setAvatarId = () => {\r\n        if(!offer.avatarUrl) {\r\n            setCover(offer.offerPhoto[0].id)\r\n        } else {\r\n            let avatar = offer.offerPhoto.find(item => item.photoUrl === offer.avatarUrl)\r\n            if(avatar && avatar.id) {\r\n                setCover(avatar.id)\r\n            }\r\n        }\r\n    }\r\n\r\n    const onDrop = (files) => {\r\n        // setPhotos([...photos, ...files])\r\n        // setStep(2)\r\n        onUploadFiles(files)\r\n    }\r\n    const onUploadFiles = async (files) => {\r\n        let data = new FormData();\r\n        data.append(\"offerId\", id);\r\n        files.forEach(file => {\r\n            if(!file.id || file.blob) {\r\n                if(file.blob) {\r\n                    data.append(\"file\", file.blob, file.name)\r\n                } else {\r\n                    data.append(\"file\", file, file.name)\r\n                }\r\n            }\r\n        });\r\n        setUploading(true)\r\n        let res = await apiOfferPhotos(data)\r\n        if(res.data) {\r\n            setPhotos([...photos, ...res.data])\r\n            if(res.data[0]) setCover(res.data[0].id)\r\n        }\r\n        setUploading(false)\r\n        setStep(2)\r\n    }\r\n    const onSetCover = id => {\r\n        setCover(id)\r\n        setStep(2)\r\n    }\r\n    const handleChangeStep = i => {\r\n        if(step === 5 && i === -1) {\r\n            setStep(2)\r\n            return\r\n        }\r\n        if((step === 1 || step === 2 ) && i === -1) {\r\n            Router.push('/offers/[id]/params', `/offers/${id}/params`, {shallow: true})\r\n        } else {\r\n            setStep(step + i)\r\n        }\r\n    }\r\n    const handleSave = async () => {\r\n        if(step == 1) {\r\n            apiEditOffer(id, {step: 2})\r\n            Router.push('/offers/[id]/regulations', `/offers/${id}/regulations`, {shallow: true})\r\n        }\r\n        if(step == 2) {\r\n            let data = new FormData();\r\n            data.append(\"offerId\", id);\r\n            photos.forEach(file => {\r\n                if(!file.id || file.blob) {\r\n                    if(file.blob) {\r\n                        data.append(\"file\", file.blob, file.name)\r\n                    } else {\r\n                        data.append(\"file\", file, file.name)\r\n                    }\r\n                }\r\n            });\r\n            handleSendPhotos(data)\r\n\r\n            // let photosDeleting = photos.filter((item, key) => (item.blob && item.id))\r\n            // if(photosDeleting.length) {\r\n            //     Promise.all(photosDeleting.map(item => handleRemovePhoto(item.id)))\r\n            //         .then(res => {\r\n            //             handleSendPhotos(data)\r\n            //         })\r\n            // } else {\r\n            //     handleSendPhotos(data)\r\n            // }\r\n\r\n        } else if(step == 5) {\r\n            let filterV = videos.filter(item => !!item)\r\n            const res = await apiEditOffer(id, {step: 2, videoUrl: filterV})\r\n            setOffer({...offer, videoUrl: res.data.videoUrl})\r\n            Router.push('/offers/[id]/regulations', `/offers/${id}/regulations`, {shallow: true})\r\n        }\r\n    }\r\n\r\n    const handleSendPhotos = data => {\r\n        //TODO optimaze and don't send if something not changed\r\n\r\n        setLoading(true)\r\n        apiSetOfferCoverPhoto(id,{offerPhotoId: cover})\r\n            .then(res => {\r\n                debugger\r\n                setOffer({...offer, avatarUrl: res.data.avatarUrl})\r\n            })\r\n\r\n        let photosWithDesc = photos.filter(item => item.description)\r\n        Promise.all(photosWithDesc.map(item => handleEditPhoto(item)))\r\n            .then(res => {\r\n               console.log('res', res)\r\n            })\r\n\r\n        apiOfferPhotos(data)\r\n            .then(res => {\r\n                setLoading(false)\r\n                let photosFilter = photos.filter((item) => {\r\n                    return (item.id && !item.blob)\r\n                })\r\n                setPhotos([...photosFilter, ...res.data])\r\n                setOffer({...offer, offerPhoto: [...photosFilter, ...res.data]})\r\n                setStep(5)\r\n            })\r\n            .catch(e => {\r\n                showNotification('error', e)\r\n                setLoading(false)\r\n            })\r\n    }\r\n\r\n    const handleEditPhoto = async photo => {\r\n        const res = await apiEditOfferPhoto(photo)\r\n        console.log(res)\r\n        return res\r\n    }\r\n\r\n    const handleRemovePhoto = async id => {\r\n        const res = await apiRemoveOfferPhoto(id)\r\n        console.log(res)\r\n        return res\r\n    }\r\n\r\n    const handleDeletePhoto = async (key) => {\r\n        let photoByKey = photos[key];\r\n        if(photoByKey.id) {\r\n            const res = await handleRemovePhoto(photoByKey.id)\r\n            let photosClone = [...photos]\r\n            photosClone.splice(key, 1)\r\n            setPhotos(photosClone)\r\n            setStep(2)\r\n        } else {\r\n            let photosClone = [...photos]\r\n            photosClone.splice(key, 1)\r\n            setPhotos(photosClone)\r\n            setStep(2)\r\n        }\r\n    }\r\n\r\n    const setEditablePhoto = (photo, key) => {\r\n        setPhotoEditable(photo)\r\n        setKeyPhoto(key)\r\n        setStep(4)\r\n    }\r\n    const handleBackFromEdit = () => {\r\n        setPhotoEditable({})\r\n        setKeyPhoto(null)\r\n        setStep(2)\r\n    }\r\n    const handleRotate = async (blob, url, key) => {\r\n        try {\r\n            let photosCopy = [...photos],\r\n                ephoto = photosCopy[key],\r\n                isCover = !!(cover == ephoto.id)\r\n\r\n            setLoadingEdit(true)\r\n            let data = new FormData();\r\n            data.append(\"offerId\", offer.id);\r\n            data.append(\"file\", blob, 'blob file')\r\n            let res = await apiOfferPhotos(data)\r\n            if(ephoto && ephoto.id) {\r\n                await handleRemovePhoto(ephoto.id)\r\n            }\r\n            if(isCover) {\r\n                setCover(res.data[0].id)\r\n            }\r\n            photosCopy[key] = res.data[0]\r\n            setPhotos(photosCopy)\r\n            setLoadingEdit(false)\r\n            setStep(2)\r\n        }\r\n        catch (e) {\r\n            showNotification('error', e)\r\n            setLoadingEdit(false)\r\n        }\r\n\r\n    }\r\n\r\n    const onChangePhotoDescription = (id, value) => {\r\n        value = value.slice(0, 100)\r\n        let photosClone = [...photos]\r\n        let key = photosClone.findIndex(item => item.id === id)\r\n        photosClone[key].description = value\r\n        setPhotos(photosClone)\r\n        console.log(key, value)\r\n    }\r\n\r\n    const disabled = loading;\r\n\r\n    return (\r\n        <>\r\n            <Header isReg />\r\n            <Wrapper p={17} pt={35}>\r\n                {offer.id ?\r\n                    <>\r\n                    <ContainerDesktop isOffer>\r\n                        <WrapperHeight>\r\n                            {uploading && <div className='photo-uploading-router'> Uploading... </div>}\r\n\r\n                            {step === 1 && <Upload onDrop={onDrop} />}\r\n                            {step === 2 &&\r\n                                <Photos\r\n                                    onDrop={onDrop}\r\n                                    setStep={setStep}\r\n                                    cover={cover}\r\n                                    photos={photos}\r\n                                    setEditablePhoto={setEditablePhoto}\r\n                                    isHiddenDeleting={true}\r\n                                />\r\n                            }\r\n                            {step === 3 &&\r\n                                <CoverPhoto\r\n                                    photos={photos}\r\n                                    setCover={onSetCover}\r\n                                    handleBack={handleBackFromEdit}\r\n                                    cover={cover}\r\n                                />\r\n                            }\r\n                            {step === 4 &&\r\n                                <EditPhoto\r\n                                    keyPhoto={keyPhoto}\r\n                                    photo={photoEditable}\r\n                                    handleBack={handleBackFromEdit}\r\n                                    handleRotate={handleRotate}\r\n                                    handleDelete={handleDeletePhoto}\r\n                                    onChangePhotoDescription={onChangePhotoDescription}\r\n                                    loadingEdit={loadingEdit}\r\n                                />\r\n                            }\r\n                            {step === 5 && <Video videos={videos} setVideos={(videos) => setVideos([...videos])} />}\r\n                        </WrapperHeight>\r\n                    </ContainerDesktop>\r\n\r\n                        {step !== 3 && step !== 4 &&\r\n                        <FooterDesktop>\r\n                            <Footer pt={30} >\r\n                                <Button onClick={() => handleChangeStep(-1)}>Back</Button>\r\n                                <Button blue\r\n                                        onClick={() => handleSave()}\r\n                                        loading={loading}\r\n                                >\r\n                                    {step === 1 ? 'Skip' : 'Next'}\r\n                                </Button>\r\n                            </Footer>\r\n                        </FooterDesktop>\r\n                        }\r\n\r\n                    </>\r\n                    :\r\n                    <>Loading...</>\r\n                }\r\n\r\n\r\n            </Wrapper>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default PhotosPage\r\n\r\n"]},"metadata":{},"sourceType":"module"}