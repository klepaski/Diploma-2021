{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport Router from 'next/router';\nimport { apiGetOfferById } from '../actions/api';\nimport { showNotification } from \"./notification\";\n\nvar withOfferInfo = function withOfferInfo(OfferComponent) {\n  return (\n    /*#__PURE__*/\n    function (_Component) {\n      _inherits(OfferWrapper, _Component);\n\n      _createClass(OfferWrapper, null, [{\n        key: \"getInitialProps\",\n        value: function getInitialProps(_ref) {\n          var req, res, query;\n          return _regeneratorRuntime.async(function getInitialProps$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  req = _ref.req, res = _ref.res, query = _ref.query;\n                  _context.prev = 1;\n                  return _context.abrupt(\"return\", {\n                    id: query.id\n                  });\n\n                case 5:\n                  _context.prev = 5;\n                  _context.t0 = _context[\"catch\"](1);\n                  console.log('ошибка', _context.t0);\n\n                case 8:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, null, null, [[1, 5]]);\n        }\n      }]);\n\n      function OfferWrapper(props) {\n        var _this;\n\n        _classCallCheck(this, OfferWrapper);\n\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(OfferWrapper).call(this, props));\n        _this.state = {\n          offer: {},\n          offerPhotos: [],\n          loading: false\n        };\n        return _this;\n      }\n\n      _createClass(OfferWrapper, [{\n        key: \"componentDidMount\",\n        value: function componentDidMount() {\n          var _this2 = this;\n\n          if (this.props.id) {\n            apiGetOfferById(this.props.id).then(function (res) {\n              if (res.data.userId === localStorage.getItem('userId')) {\n                _this2.setState({\n                  offer: res.data\n                }, function () {\n                  _this2.setState({\n                    loading: false\n                  });\n                });\n              } else {\n                showNotification('error', 'Not allowed');\n                Router.push('/');\n              }\n            })[\"catch\"](function (e) {\n              _this2.setState({\n                loading: false\n              });\n            });\n          } else {}\n        }\n      }, {\n        key: \"render\",\n        value: function render() {\n          return __jsx(\"div\", null, this.state.loading ? __jsx(\"div\", null, \"LOADING....\") : __jsx(OfferComponent, _extends({}, this.props, {\n            offer: this.state.offer\n          })));\n        }\n      }]);\n\n      return OfferWrapper;\n    }(Component)\n  );\n};\n\nexport default withOfferInfo;","map":{"version":3,"sources":["D:/4/диплом/webapp/utils/offer.js"],"names":["React","Component","Router","apiGetOfferById","showNotification","withOfferInfo","OfferComponent","req","res","query","id","console","log","props","state","offer","offerPhotos","loading","then","data","userId","localStorage","getItem","setState","push","e"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAAQC,eAAR,QAA8B,gBAA9B;AACA,SAAQC,gBAAR,QAA+B,gBAA/B;;AAGA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,cAAD,EAAoB;AACtC;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACmCC,kBAAAA,GADnC,QACmCA,GADnC,EACwCC,GADxC,QACwCA,GADxC,EAC6CC,KAD7C,QAC6CA,KAD7C;AAAA;AAAA,mDAGmB;AAACC,oBAAAA,EAAE,EAAED,KAAK,CAACC;AAAX,mBAHnB;;AAAA;AAAA;AAAA;AAMYC,kBAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;;AANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AASI,4BAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACf,0FAAMA,KAAN;AACA,cAAKC,KAAL,GAAa;AACTC,UAAAA,KAAK,EAAE,EADE;AAETC,UAAAA,WAAW,EAAE,EAFJ;AAGTC,UAAAA,OAAO,EAAE;AAHA,SAAb;AAFe;AAOlB;;AAhBL;AAAA;AAAA,4CAkByB;AAAA;;AACjB,cAAI,KAAKJ,KAAL,CAAWH,EAAf,EAAmB;AACfP,YAAAA,eAAe,CAAC,KAAKU,KAAL,CAAWH,EAAZ,CAAf,CACKQ,IADL,CACU,UAAAV,GAAG,EAAI;AACT,kBAAGA,GAAG,CAACW,IAAJ,CAASC,MAAT,KAAoBC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAvB,EAAsD;AAClD,gBAAA,MAAI,CAACC,QAAL,CAAc;AAACR,kBAAAA,KAAK,EAAEP,GAAG,CAACW;AAAZ,iBAAd,EAAiC,YAAM;AACnC,kBAAA,MAAI,CAACI,QAAL,CAAc;AAACN,oBAAAA,OAAO,EAAE;AAAV,mBAAd;AACH,iBAFD;AAGH,eAJD,MAIO;AACHb,gBAAAA,gBAAgB,CAAC,OAAD,EAAU,aAAV,CAAhB;AACAF,gBAAAA,MAAM,CAACsB,IAAP,CAAY,GAAZ;AACH;AACJ,aAVL,WAWW,UAAAC,CAAC,EAAI;AACR,cAAA,MAAI,CAACF,QAAL,CAAc;AAACN,gBAAAA,OAAO,EAAE;AAAV,eAAd;AACH,aAbL;AAcH,WAfD,MAeO,CAEN;AACJ;AArCL;AAAA;AAAA,iCAuCa;AACL,iBACI,mBACK,KAAKH,KAAL,CAAWG,OAAX,GACG,iCADH,GAGG,MAAC,cAAD,eAAoB,KAAKJ,KAAzB;AAAiC,YAAA,KAAK,EAAE,KAAKC,KAAL,CAAWC;AAAnD,aAJR,CADJ;AASH;AAjDL;;AAAA;AAAA,MAAkCd,SAAlC;AAAA;AAmDH,CApDD;;AAsDA,eAAeI,aAAf","sourcesContent":["import React, {Component} from 'react'\r\nimport Router from 'next/router'\r\nimport {apiGetOfferById} from '../actions/api'\r\nimport {showNotification} from \"./notification\";\r\n\r\n\r\nconst withOfferInfo = (OfferComponent) => {\r\n    return class OfferWrapper extends Component {\r\n        static async getInitialProps ({req, res, query}) {\r\n            try {\r\n                return {id: query.id}\r\n            }\r\n            catch (err) {\r\n                console.log('ошибка', err)\r\n            }\r\n        };\r\n        constructor(props) {\r\n            super(props)\r\n            this.state = {\r\n                offer: {},\r\n                offerPhotos: [],\r\n                loading: false\r\n            };\r\n        }\r\n\r\n        componentDidMount () {\r\n            if (this.props.id) {\r\n                apiGetOfferById(this.props.id)\r\n                    .then(res => {\r\n                        if(res.data.userId === localStorage.getItem('userId')){\r\n                            this.setState({offer: res.data}, () => {\r\n                                this.setState({loading: false})\r\n                            })\r\n                        } else {\r\n                            showNotification('error', 'Not allowed')\r\n                            Router.push('/')\r\n                        }\r\n                    })\r\n                    .catch(e => {\r\n                        this.setState({loading: false})\r\n                    })\r\n            } else {\r\n\r\n            }\r\n        }\r\n\r\n        render() {\r\n            return (\r\n                <div>\r\n                    {this.state.loading ? (\r\n                        <div>LOADING....</div>\r\n                    ) : (\r\n                        <OfferComponent {...this.props}  offer={this.state.offer}/>\r\n                    )}\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\nexport default withOfferInfo;"]},"metadata":{},"sourceType":"module"}