{"ast":null,"code":"import _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext } from 'react';\nimport Link from 'next/link';\nimport styled, { css } from 'styled-components';\nimport { device } from '../../lib/mediaDevice';\nimport Header from '../../components/Header/Header';\nimport { MenuEdit } from '../../components/Profile/MenuSettings';\nimport EditProfile from '../../components/Profile/EditProfile';\nimport ProfileAvatar from '../../components/Profile/ProfileAvatar';\nimport PhotosGallery from '../../components/Profile/PhotosGallery';\nimport Verification from '../../components/Profile/Verification';\nimport { SettingsWrapper } from '../../components/Profile/styledProfileHeader';\nimport { ButtonMinHeight } from '../../components/controls/Button/Button';\nimport { Divider } from '../../components/StyledComponents/Divider';\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid';\nimport { MainContext } from '../../components/contextProviders/MainContext';\nimport { withAuthSync } from '../../utils/auth';\nimport { apiEditMe, apiEditProfilePhoto, apiDeleteProfilePhoto } from '../../actions/api';\nimport { showNotification } from '../../utils/notification';\nimport Security from \"../../components/Profile/Security\";\n\nconst Edit = () => {\n  const {\n    me,\n    setMe\n  } = useContext(MainContext);\n  const {\n    0: tab,\n    1: setTab\n  } = useState(1);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n\n  let user = _Object$assign({}, me);\n\n  const onSave = data => {\n    setLoading(true);\n    apiEditMe(data).then(async res => {\n      await setMe(res.data);\n      showNotification('info', 'profile was updated successfully');\n      setLoading(false);\n    }).catch(e => {\n      setLoading(false);\n      showNotification('error', e);\n    });\n  };\n\n  const onSavePhoto = blob => {\n    setLoading(true);\n    let data = new FormData();\n    data.append('avatar', blob, 'avatar.png');\n    apiEditProfilePhoto(user.id, data).then(async res => {\n      await setMe(res.data);\n      showNotification('info', 'profile photo was updated successfully');\n      setLoading(false);\n      setTab(1);\n    }).catch(e => {\n      setLoading(false);\n      showNotification('error', e);\n    });\n  };\n\n  const onSaveGallery = async (photosNew, cover) => {\n    let userCopy = _Object$assign({}, user, {\n      photos: photosNew,\n      coverPhoto: cover\n    });\n\n    await setMe(userCopy);\n    showNotification('info', 'profile gallery was updated successfully');\n    setLoading(false);\n  };\n\n  const handleDeleteAvatar = () => {\n    apiDeleteProfilePhoto(user.id).then(async res => {\n      await setMe(res.data);\n      showNotification('info', 'profile photo was removed successfully');\n      setLoading(false);\n      setTab(1);\n    }).catch(e => {\n      setLoading(false);\n      showNotification('error', e);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isProfile: true\n  }), __jsx(ContainerDesktop, null, __jsx(Flex, null, __jsx(FlexLeft, null, __jsx(MenuEdit, {\n    tab: tab,\n    setTab: setTab\n  })), __jsx(FlexRight, null, __jsx(SettingsWrapper, null, __jsx(TopBtnWrapper, null, __jsx(Link, {\n    href: '/profile'\n  }, __jsx(ButtonMinHeight, {\n    transparentBlue: true,\n    black: true,\n    mt: 20\n  }, \"View profile\"))), __jsx(Divider, {\n    grey: true,\n    mt: 28,\n    mb: 22\n  }), user.id ? __jsx(React.Fragment, null, tab === 1 && __jsx(EditProfile, {\n    user: user,\n    onSave: onSave,\n    loading: loading\n  }), tab === 2 && __jsx(ProfileAvatar, {\n    user: user,\n    onSavePhoto: onSavePhoto,\n    handleDeleteAvatar: handleDeleteAvatar,\n    loading: loading\n  }), tab === 3 && __jsx(PhotosGallery, {\n    photosArr: user.photo || [],\n    coverPhoto: user.coverPhoto,\n    onSave: onSaveGallery,\n    loading: loading\n  })) : __jsx(\"div\", null, \"Loading\"), __jsx(BoxCenter, null, tab === 4 && __jsx(Security, {\n    user: user,\n    loading: loading\n  })))))));\n};\n\nconst FlexLeft = styled.div``;\nconst FlexRight = styled.div``;\nconst Flex = styled.div`\n  @media ${device.laptopDesktop} {\n    display: flex;\n\n    ${FlexLeft} {\n      width: 20%;\n    }\n\n    ${FlexRight} {\n      width: 80%;\n    }\n  }\n`;\nconst TopBtnWrapper = styled.div`\n  text-align: right;\n  @media ${device.laptopDesktop} {\n    ${ButtonMinHeight} {\n      width: 200px;\n    }\n  }\n`;\nconst BoxCenter = styled.div`\n  @media ${device.laptopDesktop} {\n    width: 400px;\n    margin: 0 auto;\n  }\n`;\nexport default withAuthSync(Edit);","map":{"version":3,"sources":["D:/4/диплом/webapp/pages/profile/edit.js"],"names":["React","useState","useContext","Link","styled","css","device","Header","MenuEdit","EditProfile","ProfileAvatar","PhotosGallery","Verification","SettingsWrapper","ButtonMinHeight","Divider","ContainerDesktop","MainContext","withAuthSync","apiEditMe","apiEditProfilePhoto","apiDeleteProfilePhoto","showNotification","Security","Edit","me","setMe","tab","setTab","loading","setLoading","user","onSave","data","then","res","catch","e","onSavePhoto","blob","FormData","append","id","onSaveGallery","photosNew","cover","userCopy","photos","coverPhoto","handleDeleteAvatar","photo","FlexLeft","div","FlexRight","Flex","laptopDesktop","TopBtnWrapper","BoxCenter"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react'\r\nimport Link from 'next/link'\r\nimport styled, { css } from 'styled-components'\r\nimport { device } from '../../lib/mediaDevice'\r\nimport Header from '../../components/Header/Header'\r\nimport { MenuEdit } from '../../components/Profile/MenuSettings'\r\nimport EditProfile from '../../components/Profile/EditProfile'\r\nimport ProfileAvatar from '../../components/Profile/ProfileAvatar'\r\nimport PhotosGallery from '../../components/Profile/PhotosGallery'\r\nimport Verification from '../../components/Profile/Verification'\r\nimport { SettingsWrapper } from '../../components/Profile/styledProfileHeader'\r\nimport { ButtonMinHeight } from '../../components/controls/Button/Button'\r\nimport { Divider } from '../../components/StyledComponents/Divider'\r\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid'\r\nimport { MainContext } from '../../components/contextProviders/MainContext'\r\nimport { withAuthSync } from '../../utils/auth'\r\nimport { apiEditMe, apiEditProfilePhoto, apiDeleteProfilePhoto } from '../../actions/api'\r\nimport { showNotification } from '../../utils/notification'\r\nimport Security from \"../../components/Profile/Security\";\r\n\r\nconst Edit = () => {\r\n  const { me, setMe } = useContext(MainContext)\r\n  const [tab, setTab] = useState(1)\r\n  const [loading, setLoading] = useState(false)\r\n\r\n  let user = Object.assign({}, me)\r\n\r\n  const onSave = (data) => {\r\n    setLoading(true)\r\n    apiEditMe(data)\r\n      .then(async (res) => {\r\n        await setMe(res.data)\r\n        showNotification('info', 'profile was updated successfully')\r\n        setLoading(false)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n        showNotification('error', e)\r\n      })\r\n  }\r\n\r\n  const onSavePhoto = (blob) => {\r\n    setLoading(true)\r\n    let data = new FormData()\r\n    data.append('avatar', blob, 'avatar.png')\r\n\r\n    apiEditProfilePhoto(user.id, data)\r\n      .then(async (res) => {\r\n        await setMe(res.data)\r\n        showNotification('info', 'profile photo was updated successfully')\r\n        setLoading(false)\r\n        setTab(1)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n        showNotification('error', e)\r\n      })\r\n  }\r\n\r\n  const onSaveGallery = async (photosNew, cover) => {\r\n    let userCopy = Object.assign({}, user, { photos: photosNew, coverPhoto: cover })\r\n    await setMe(userCopy)\r\n    showNotification('info', 'profile gallery was updated successfully')\r\n    setLoading(false)\r\n  }\r\n\r\n  const handleDeleteAvatar = () => {\r\n    apiDeleteProfilePhoto(user.id)\r\n      .then(async (res) => {\r\n        await setMe(res.data)\r\n        showNotification('info', 'profile photo was removed successfully')\r\n        setLoading(false)\r\n        setTab(1)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n        showNotification('error', e)\r\n      })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Header isProfile />\r\n\r\n      <ContainerDesktop>\r\n        <Flex>\r\n          <FlexLeft>\r\n            <MenuEdit tab={tab} setTab={setTab} />\r\n          </FlexLeft>\r\n          <FlexRight>\r\n            <SettingsWrapper>\r\n              <TopBtnWrapper>\r\n                <Link href={'/profile'}>\r\n                  <ButtonMinHeight transparentBlue black mt={20}>\r\n                    View profile\r\n                  </ButtonMinHeight>\r\n                </Link>\r\n              </TopBtnWrapper>\r\n\r\n              <Divider grey mt={28} mb={22} />\r\n\r\n              {user.id ? (\r\n                <>\r\n                  {tab === 1 && <EditProfile user={user} onSave={onSave} loading={loading} />}\r\n                  {tab === 2 && (\r\n                    <ProfileAvatar\r\n                      user={user}\r\n                      onSavePhoto={onSavePhoto}\r\n                      handleDeleteAvatar={handleDeleteAvatar}\r\n                      loading={loading}\r\n                    />\r\n                  )}\r\n                  {tab === 3 && (\r\n                    <PhotosGallery\r\n                      photosArr={user.photo || []}\r\n                      coverPhoto={user.coverPhoto}\r\n                      onSave={onSaveGallery}\r\n                      loading={loading}\r\n                    />\r\n                  )}\r\n                </>\r\n              ) : (\r\n                <div>Loading</div>\r\n              )}\r\n                <BoxCenter>{tab === 4 && <Security user={user} loading={loading} />}</BoxCenter>\r\n\r\n            </SettingsWrapper>\r\n          </FlexRight>\r\n        </Flex>\r\n      </ContainerDesktop>\r\n    </>\r\n  )\r\n}\r\n\r\nconst FlexLeft = styled.div``\r\nconst FlexRight = styled.div``\r\n\r\nconst Flex = styled.div`\r\n  @media ${device.laptopDesktop} {\r\n    display: flex;\r\n\r\n    ${FlexLeft} {\r\n      width: 20%;\r\n    }\r\n\r\n    ${FlexRight} {\r\n      width: 80%;\r\n    }\r\n  }\r\n`\r\nconst TopBtnWrapper = styled.div`\r\n  text-align: right;\r\n  @media ${device.laptopDesktop} {\r\n    ${ButtonMinHeight} {\r\n      width: 200px;\r\n    }\r\n  }\r\n`\r\nconst BoxCenter = styled.div`\r\n  @media ${device.laptopDesktop} {\r\n    width: 400px;\r\n    margin: 0 auto;\r\n  }\r\n`\r\n\r\nexport default withAuthSync(Edit)\r\n"]},"metadata":{},"sourceType":"module"}