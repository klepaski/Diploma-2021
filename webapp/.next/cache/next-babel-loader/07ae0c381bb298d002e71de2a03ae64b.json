{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport Router from 'next/router';\nimport { Title, Footer, Label2 } from '../../components/Layouts/styledLayouts';\nimport styled, { css } from 'styled-components';\nimport { device } from '../../lib/mediaDevice';\nimport { Wrapper, WrapperHeight } from '../../components/StyledComponents/Wrapper';\nimport { Button, ButtonMin } from '../../components/controls/Button/Button';\nimport Header from '../../components/Header/Header';\nimport { Text } from '../../components/StyledComponents/Text';\nimport { FlexBlock } from '../../components/StyledComponents/FlexBlock';\nimport { apiEditOffer, apiGetListUserOffers } from '../../actions/api';\nimport { MainContext } from '../../components/contextProviders/MainContext';\nimport OfferCardItemBig from '../../components/Offer/cards/OfferCardItemBig';\nimport { showNotification } from '../../utils/notification';\nimport { PlusPurple, Preferences } from '../../components/StyledComponents/Icon';\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid';\n\nconst ProfileOffers = () => {\n  const {\n    me,\n    listOffers\n  } = useContext(MainContext);\n  const {\n    0: list,\n    1: setList\n  } = useState(listOffers);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(true);\n  const {\n    0: isPublishing,\n    1: setIsPublishing\n  } = useState(false);\n  useEffect(() => {\n    if (me.id) getListOffers();\n  }, [me.id]);\n\n  const getListOffers = () => {\n    setLoading(true);\n    apiGetListUserOffers(me.id).then(res => {\n      setList(res.data);\n      setLoading(false);\n    }).catch(e => {\n      setLoading(false);\n    });\n  };\n\n  const handlePublishOffer = id => {\n    let data = {\n      status: 'open'\n    };\n    setIsPublishing(true);\n    apiEditOffer(id, data).then(res => {\n      let clone = [...list];\n      let index = clone.findIndex(x => x.id === id);\n      clone[index] = res.data;\n      setList(clone);\n      showNotification('info', 'Offer was published successfully');\n      setIsPublishing(false);\n    }).catch(e => {\n      showNotification('error', e);\n      setIsPublishing(false);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isProfile: true\n  }), __jsx(Wrapper, {\n    p: 15\n  }, __jsx(ContainerDesktop, null, __jsx(FlexBlock, {\n    mb: 30\n  }, __jsx(Text, {\n    fz: 18,\n    pt: '5px'\n  }, \"Listing\"), __jsx(Box, null, list.length ? __jsx(React.Fragment, null, __jsx(PlusPurple, {\n    ml: 30,\n    onClick: () => Router.push('/offers/create')\n  })) : __jsx(Button, {\n    transparentPurple: true,\n    onClick: () => {\n      Router.push('/offers/create');\n    }\n  }, \"Create an offer\"))), loading && __jsx(\"div\", null, \"Loading... \"), list.length ? __jsx(WrapOffers, null, list.map((offer, key) => __jsx(OfferCardItemBig, {\n    key: offer.id,\n    offer: offer,\n    handlePublishOffer: handlePublishOffer,\n    isPublishing: isPublishing\n  }))) : __jsx(Center, null, !loading && __jsx(Title, null, \"You have no offers yet\")))));\n};\n\nexport default ProfileOffers;\nconst WrapOffers = styled.div`\n  @media ${device.laptopDesktop} {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: space-between;\n\n    > div {\n      width: 30%;\n      min-height: 350px;\n    }\n  }\n`;\nconst Box = styled.div`\n  ${Preferences} {\n    cursor: pointer;\n  }\n  ${PlusPurple} {\n    cursor: pointer;\n  }\n`;\nconst Center = styled.div`\n  ${Title} {\n    text-align: center;\n  }\n`;","map":{"version":3,"sources":["D:/4/диплом/webapp — копия/pages/profile/offers.js"],"names":["React","useState","useContext","useEffect","Router","Title","Footer","Label2","styled","css","device","Wrapper","WrapperHeight","Button","ButtonMin","Header","Text","FlexBlock","apiEditOffer","apiGetListUserOffers","MainContext","OfferCardItemBig","showNotification","PlusPurple","Preferences","ContainerDesktop","ProfileOffers","me","listOffers","list","setList","loading","setLoading","isPublishing","setIsPublishing","id","getListOffers","then","res","data","catch","e","handlePublishOffer","status","clone","index","findIndex","x","length","push","map","offer","key","WrapOffers","div","laptopDesktop","Box","Center"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\r\nimport Router from 'next/router'\r\nimport { Title, Footer, Label2 } from '../../components/Layouts/styledLayouts'\r\nimport styled, { css } from 'styled-components'\r\nimport { device } from '../../lib/mediaDevice'\r\nimport { Wrapper, WrapperHeight } from '../../components/StyledComponents/Wrapper'\r\nimport { Button, ButtonMin } from '../../components/controls/Button/Button'\r\nimport Header from '../../components/Header/Header'\r\nimport { Text } from '../../components/StyledComponents/Text'\r\nimport { FlexBlock } from '../../components/StyledComponents/FlexBlock'\r\nimport { apiEditOffer, apiGetListUserOffers } from '../../actions/api'\r\nimport { MainContext } from '../../components/contextProviders/MainContext'\r\nimport OfferCardItemBig from '../../components/Offer/cards/OfferCardItemBig'\r\nimport { showNotification } from '../../utils/notification'\r\nimport { PlusPurple, Preferences } from '../../components/StyledComponents/Icon'\r\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid'\r\n\r\nconst ProfileOffers = () => {\r\n  const { me, listOffers } = useContext(MainContext)\r\n  const [list, setList] = useState(listOffers)\r\n  const [loading, setLoading] = useState(true)\r\n  const [isPublishing, setIsPublishing] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (me.id) getListOffers()\r\n  }, [me.id])\r\n\r\n  const getListOffers = () => {\r\n    setLoading(true)\r\n    apiGetListUserOffers(me.id)\r\n      .then((res) => {\r\n        setList(res.data)\r\n        setLoading(false)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n      })\r\n  }\r\n\r\n  const handlePublishOffer = (id) => {\r\n    let data = {\r\n      status: 'open',\r\n    }\r\n    setIsPublishing(true)\r\n    apiEditOffer(id, data)\r\n      .then((res) => {\r\n        let clone = [...list]\r\n        let index = clone.findIndex((x) => x.id === id)\r\n        clone[index] = res.data\r\n        setList(clone)\r\n        showNotification('info', 'Offer was published successfully')\r\n        setIsPublishing(false)\r\n      })\r\n      .catch((e) => {\r\n        showNotification('error', e)\r\n        setIsPublishing(false)\r\n      })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Header isProfile />\r\n      <Wrapper p={15}>\r\n        <ContainerDesktop>\r\n          <FlexBlock mb={30}>\r\n            <Text fz={18} pt={'5px'}>\r\n              Listing\r\n            </Text>\r\n            <Box>\r\n              {list.length ? (\r\n                <>\r\n                  <PlusPurple ml={30} onClick={() => Router.push('/offers/create')} />\r\n                </>\r\n              ) : (\r\n                <Button\r\n                  transparentPurple\r\n                  onClick={() => {\r\n                    Router.push('/offers/create')\r\n                  }}\r\n                >\r\n                  Create an offer\r\n                </Button>\r\n              )}\r\n            </Box>\r\n          </FlexBlock>\r\n\r\n          {loading && <div>Loading... </div>}\r\n\r\n          {list.length ? (\r\n            <WrapOffers>\r\n              {list.map((offer, key) => (\r\n                <OfferCardItemBig\r\n                  key={offer.id}\r\n                  offer={offer}\r\n                  handlePublishOffer={handlePublishOffer}\r\n                  isPublishing={isPublishing}\r\n                />\r\n              ))}\r\n            </WrapOffers>\r\n          ) : (\r\n            <Center>{!loading && <Title>You have no offers yet</Title>}</Center>\r\n          )}\r\n        </ContainerDesktop>\r\n      </Wrapper>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ProfileOffers\r\n\r\nconst WrapOffers = styled.div`\r\n  @media ${device.laptopDesktop} {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: space-between;\r\n\r\n    > div {\r\n      width: 30%;\r\n      min-height: 350px;\r\n    }\r\n  }\r\n`\r\nconst Box = styled.div`\r\n  ${Preferences} {\r\n    cursor: pointer;\r\n  }\r\n  ${PlusPurple} {\r\n    cursor: pointer;\r\n  }\r\n`\r\nconst Center = styled.div`\r\n  ${Title} {\r\n    text-align: center;\r\n  }\r\n`\r\n"]},"metadata":{},"sourceType":"module"}