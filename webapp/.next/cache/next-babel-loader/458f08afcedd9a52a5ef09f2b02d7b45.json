{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext } from 'react';\nimport Link from \"next/link\";\nimport Router from 'next/router';\nimport MainProvider, { MainContext, MainConsumer } from \"../components/contextProviders/MainContext\";\nimport { Wrapper } from \"../components/StyledComponents/Wrapper\";\nimport { Button } from \"../components/controls/Button/Button\";\nimport { Divider } from \"../components/StyledComponents/Divider\";\nimport { Close } from '../components/StyledComponents/Icon';\nimport { FlexBlock } from '../components/StyledComponents/FlexBlock';\nimport { Text } from \"../components/StyledComponents/Text\";\nimport { Input } from '../components/controls/Input/Input';\nimport validate from \"../utils/validation\";\nimport { apiLoginUser } from \"../actions/api\";\nimport { showNotification } from \"../utils/notification\";\nimport { auth, login } from \"../utils/auth\";\nimport { initAxios } from \"../config/axios\";\n\nvar LoginPage = function LoginPage() {\n  var _useState = useState(''),\n      email = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(''),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var _useState3 = useState(false),\n      loading = _useState3[0],\n      setLoading = _useState3[1];\n\n  var onChangeEmail = function onChangeEmail(e) {\n    var value = e.target.value;\n    setEmail(value);\n  };\n\n  var onChangePassword = function onChangePassword(e) {\n    var value = e.target.value;\n    setPassword(value);\n  };\n\n  var _useContext = useContext(MainContext),\n      setMe = _useContext.setMe;\n\n  var handleSubmit = function handleSubmit() {\n    setLoading(true);\n    apiLoginUser({\n      email: email.toLowerCase(),\n      password: password\n    }).then(function _callee(res) {\n      var _res$data, token, id;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _res$data = res.data, token = _res$data.token, id = _res$data.id;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(login({\n                token: token,\n                id: id\n              }));\n\n            case 3:\n              _context.next = 5;\n              return _regeneratorRuntime.awrap(setMe(res.data));\n\n            case 5:\n              // TODO check if is first time\n              initAxios(function () {\n                Router.push('/');\n              });\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    })[\"catch\"](function (err) {\n      setLoading(false);\n      showNotification('error', err);\n    });\n  };\n\n  var disabled = loading || !email || !password;\n  return __jsx(React.Fragment, null, __jsx(Wrapper, {\n    p: 25\n  }, __jsx(Wrapper, {\n    mb: 35\n  }, __jsx(Close, {\n    onClick: function onClick() {\n      return Router.back();\n    }\n  })), __jsx(Wrapper, {\n    textCenter: true,\n    mb: 20\n  }, \"Login with \", __jsx(\"a\", {\n    href: 'https://talentbooking.net/api/v1/user/auth/facebook'\n  }, \"Facebook\"), \" or \", __jsx(\"a\", {\n    href: 'https://talentbooking.net/api/v1/user/auth/google'\n  }, \"Google\")), __jsx(FlexBlock, {\n    mb: 20\n  }, __jsx(Divider, {\n    grey: true,\n    full: true\n  }), __jsx(Text, {\n    fz: 15\n  }, \"or\"), __jsx(Divider, {\n    grey: true,\n    full: true\n  })), __jsx(Input, {\n    type: 'text',\n    value: email,\n    onChange: onChangeEmail,\n    placeholder: \"Email address\",\n    mb: '5px',\n    fz: 15\n  }), __jsx(Input, {\n    type: 'password',\n    value: password,\n    placeholder: \"Password\",\n    onChange: onChangePassword,\n    fz: 15\n  }), __jsx(Button, {\n    green: true,\n    mt: 25,\n    onClick: handleSubmit,\n    loading: loading\n  }, \"Login\"), __jsx(Divider, {\n    grey: true,\n    full: true,\n    mt: 25,\n    mb: 15\n  }), __jsx(FlexBlock, {\n    right: true\n  }, __jsx(Text, {\n    mr: 10\n  }, \"New to Talentbooking?\"), __jsx(Link, {\n    href: '/registration'\n  }, __jsx(\"a\", null, __jsx(Text, {\n    isLink: true,\n    textRight: true\n  }, \"Sign up\"))))));\n};\n\nexport default LoginPage;","map":{"version":3,"sources":["D:/git/webapp3/webapp/pages/login.js"],"names":["React","useState","useContext","Link","Router","MainProvider","MainContext","MainConsumer","Wrapper","Button","Divider","Close","FlexBlock","Text","Input","validate","apiLoginUser","showNotification","auth","login","initAxios","LoginPage","email","setEmail","password","setPassword","loading","setLoading","onChangeEmail","e","value","target","onChangePassword","setMe","handleSubmit","toLowerCase","then","res","data","token","id","push","err","disabled","back"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport Link from \"next/link\";\r\nimport Router from 'next/router'\r\nimport MainProvider, { MainContext, MainConsumer } from \"../components/contextProviders/MainContext\"\r\n\r\nimport {Wrapper} from \"../components/StyledComponents/Wrapper\";\r\nimport {Button} from \"../components/controls/Button/Button\";\r\nimport {Divider} from \"../components/StyledComponents/Divider\";\r\nimport {Close} from '../components/StyledComponents/Icon'\r\nimport {FlexBlock} from '../components/StyledComponents/FlexBlock'\r\nimport {Text} from \"../components/StyledComponents/Text\";\r\nimport {Input} from '../components/controls/Input/Input'\r\nimport validate from \"../utils/validation\";\r\nimport {apiLoginUser} from \"../actions/api\";\r\nimport {showNotification} from \"../utils/notification\";\r\nimport {auth, login} from \"../utils/auth\";\r\nimport {initAxios} from \"../config/axios\";\r\n\r\nconst LoginPage = () => {\r\n    const [email, setEmail] = useState('')\r\n    const [password, setPassword] = useState('')\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    const onChangeEmail = e => {\r\n        let {value} = e.target\r\n        setEmail(value)\r\n    }\r\n    const onChangePassword = e => {\r\n        let {value} = e.target\r\n        setPassword(value)\r\n    }\r\n    const {setMe} = useContext(MainContext)\r\n\r\n    const handleSubmit = () => {\r\n        setLoading(true);\r\n        apiLoginUser({email: email.toLowerCase(), password})\r\n            .then(async res => {\r\n                let {token, id} = res.data;\r\n                await login({ token, id })\r\n                await setMe(res.data)\r\n                // TODO check if is first time\r\n                initAxios(() => {\r\n                    Router.push('/')\r\n                })\r\n\r\n            })\r\n            .catch(err => {\r\n                setLoading(false);\r\n                showNotification('error', err)\r\n            })\r\n    }\r\n\r\n\r\n\r\n    let disabled = loading || !email || !password;\r\n\r\n    return (\r\n        <>\r\n            <Wrapper p={25}>\r\n                <Wrapper mb={35}>\r\n                    <Close onClick={() => Router.back()} />\r\n                </Wrapper>\r\n                <Wrapper textCenter mb={20} >\r\n                    Login with <a href={'https://talentbooking.net/api/v1/user/auth/facebook'}>Facebook</a> or <a href={'https://talentbooking.net/api/v1/user/auth/google'}>Google</a>\r\n                </Wrapper>\r\n                <FlexBlock mb={20} >\r\n                    <Divider grey full/>\r\n                    <Text fz={15} >or</Text>\r\n                    <Divider grey full />\r\n                </FlexBlock>\r\n                <Input type={'text'}\r\n                       value={email}\r\n                       onChange={onChangeEmail}\r\n                       placeholder=\"Email address\"\r\n                       mb={'5px'}\r\n                       fz={15}\r\n                />\r\n                <Input type={'password'}\r\n                       value={password}\r\n                       placeholder=\"Password\"\r\n                       onChange={onChangePassword}\r\n                       fz={15}\r\n                />\r\n                <Button green mt={25} onClick={handleSubmit} loading={loading} >Login</Button>\r\n                <Divider grey full mt={25} mb={15} />\r\n                <FlexBlock right>\r\n                    <Text mr={10} >New to Talentbooking?</Text>\r\n                    <Link href={'/registration'}>\r\n                        <a><Text isLink textRight >Sign up</Text></a>\r\n                    </Link>\r\n                </FlexBlock>\r\n            </Wrapper>\r\n\r\n        </>\r\n    );\r\n};\r\n\r\nexport default LoginPage;\r\n"]},"metadata":{},"sourceType":"module"}