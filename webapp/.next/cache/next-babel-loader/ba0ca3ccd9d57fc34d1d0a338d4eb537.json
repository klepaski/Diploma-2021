{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _parseFloat from \"@babel/runtime-corejs2/core-js/parse-float\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport Dropzone from 'react-dropzone';\nimport AvatarEditor from 'react-avatar-editor';\nimport { UploadImg, IcAvatar } from '../../StyledComponents/Icon';\nimport { Text } from \"../../StyledComponents/Text\";\nimport './styles.css';\nimport { Button } from \"../Button/Button\";\nimport IconRotateRight from '../../../static/img/icon-rotate-right.png';\n\nvar RegAvatar =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RegAvatar, _React$Component);\n\n  function RegAvatar(props) {\n    var _this;\n\n    _classCallCheck(this, RegAvatar);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RegAvatar).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getImage\", function () {\n      if (_this.state.image) {\n        _this.editor.getImageScaledToCanvas().toBlob(function (blob) {\n          return blob;\n        }.bind(_assertThisInitialized(_this)), 'image/jpeg', 1);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSave\", function (data) {\n      var img = _this.editor.getImageScaledToCanvas().toDataURL();\n\n      var rect = _this.editor.getCroppingRect();\n\n      _this.setState({\n        preview: {\n          img: img,\n          rect: rect,\n          scale: _this.state.scale,\n          width: _this.state.width,\n          height: _this.state.height,\n          borderRadius: _this.state.borderRadius\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleScale\", function (e) {\n      var scale = _parseFloat(e.target.value);\n\n      _this.setState({\n        scale: scale\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleAllowZoomOut\", function (_ref) {\n      var allowZoomOut = _ref.target.checked;\n\n      _this.setState({\n        allowZoomOut: allowZoomOut\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"rotateLeft\", function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        rotate: _this.state.rotate - 90\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"rotateRight\", function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        rotate: _this.state.rotate + 90\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleBorderRadius\", function (e) {\n      var borderRadius = _parseInt(e.target.value);\n\n      _this.setState({\n        borderRadius: borderRadius\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleXPosition\", function (e) {\n      var x = _parseFloat(e.target.value);\n\n      _this.setState({\n        position: _objectSpread({}, _this.state.position, {\n          x: x\n        })\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleYPosition\", function (e) {\n      var y = _parseFloat(e.target.value);\n\n      _this.setState({\n        position: _objectSpread({}, _this.state.position, {\n          y: y\n        })\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleWidth\", function (e) {\n      var width = _parseInt(e.target.value);\n\n      _this.setState({\n        width: width\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleHeight\", function (e) {\n      var height = _parseInt(e.target.value);\n\n      _this.setState({\n        height: height\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setEditorRef\", function (editor) {\n      if (editor) _this.editor = editor;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePositionChange\", function (position) {\n      _this.setState({\n        position: position\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleNewImage\", function (e) {\n      _this.setState({\n        image: e.target.files[0]\n      });\n    });\n\n    _this.state = {\n      allowZoomOut: false,\n      positiD: {\n        x: 0.5,\n        y: 0.5\n      },\n      scale: 1,\n      rotate: 0,\n      borderRadius: 256,\n      preview: null,\n      width: 512,\n      height: 512\n    };\n    _this.onCrop = _this.onCrop.bind(_assertThisInitialized(_this));\n    _this.onCropDefault = _this.onCropDefault.bind(_assertThisInitialized(_this));\n    _this.onCloseDefault = _this.onCloseDefault.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(RegAvatar, [{\n    key: \"onDrop\",\n    value: function onDrop(accepted, rejected) {\n      if (accepted.length) {\n        this.setState({\n          image: accepted[0]\n        });\n        this.handleScale({\n          target: {\n            value: '1.01'\n          }\n        });\n      }\n\n      if (rejected.length) {\n        console.log('rejected');\n        this.setState({\n          fileError: 'The uploaded file seems to have incorrect format'\n        });\n      }\n    }\n  }, {\n    key: \"onCropDefault\",\n    value: function onCropDefault(preview) {\n      this.setState({\n        defaultPreview: preview,\n        newAvatar: true\n      });\n      var binary = atob(preview.split(',')[1]);\n      var array = [];\n\n      for (var i = 0; i < binary.length; i++) {\n        array.push(binary.charCodeAt(i));\n      }\n\n      var img = new Blob([new Uint8Array(array)], {\n        type: 'image/jpeg'\n      });\n      this.setState({\n        avatar: img\n      });\n    }\n  }, {\n    key: \"onCrop\",\n    value: function onCrop(preview) {\n      this.setState({\n        preview: preview\n      });\n    }\n  }, {\n    key: \"onCloseDefault\",\n    value: function onCloseDefault() {\n      this.setState({\n        defaultPreview: null,\n        newAvatar: false,\n        preview: null\n      });\n    }\n  }, {\n    key: \"logCallback\",\n    value: function logCallback(e) {\n      if (e === 'onLoadSuccess' && this.props.onLoadSuccess) this.props.onLoadSuccess();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var profilePhotoURL = this.props.profilePhotoURL;\n      var image = this.state.image;\n      var dropStyle = {\n        'width': '100%',\n        'height': 'auto',\n        'margin': '0 auto',\n        'border': 'none',\n        'display': 'table'\n      };\n      var styleCanvas = {\n        'width': '240px',\n        'height': '240px'\n      };\n\n      function ActionLink() {\n        document.getElementById('input_load_file_2').click();\n      }\n\n      return __jsx(React.Fragment, null, !image && __jsx(\"div\", {\n        className: \"shell-load-img-cart\"\n      }, __jsx(\"div\", {\n        className: \"block-load-img\"\n      }, __jsx(\"section\", {\n        className: \"section-wrap-upload\"\n      }, profilePhotoURL ? __jsx(\"img\", {\n        src: profilePhotoURL,\n        alt: \"logo\"\n      }) : __jsx(IcAvatar, null)))), image && __jsx(React.Fragment, null, __jsx(\"div\", {\n        className: \"wrap-canvas-avatar\"\n      }, __jsx(AvatarEditor, {\n        ref: this.setEditorRef,\n        scale: _parseFloat(this.state.scale),\n        width: this.state.width,\n        height: this.state.height,\n        position: this.state.position,\n        onPositionChange: this.handlePositionChange,\n        rotate: _parseFloat(this.state.rotate),\n        borderRadius: this.state.borderRadius,\n        onSave: this.handleSave,\n        onLoadFailure: this.logCallback.bind(this, 'onLoadFailed'),\n        onLoadSuccess: this.logCallback.bind(this, 'onLoadSuccess'),\n        onImageReady: this.logCallback.bind(this, 'onImageReady'),\n        onImageLoad: this.logCallback.bind(this, 'onImageLoad'),\n        onDropFile: this.logCallback.bind(this, 'onDropFile'),\n        color: [0, 0, 0, 0.8],\n        style: styleCanvas,\n        image: this.state.image || UploadImg\n      })), __jsx(\"div\", {\n        className: 'zoom-inp'\n      }, __jsx(\"input\", {\n        name: \"scale\",\n        type: \"range\",\n        onChange: this.handleScale,\n        min: this.state.allowZoomOut ? '0.1' : '1',\n        max: \"4\",\n        step: \"0.01\",\n        defaultValue: \"1\"\n      })), __jsx(\"div\", {\n        style: {\n          textAlign: 'center',\n          marginBottom: '10px'\n        }\n      }, __jsx(\"img\", {\n        style: {\n          width: '15px'\n        },\n        src: IconRotateRight,\n        alt: \"rotate\",\n        onClick: function onClick(e) {\n          return _this2.rotateRight(e);\n        }\n      }))), __jsx(Text, {\n        fz: 14,\n        mb: 30,\n        grey6: true\n      }, \"Clear high-quality frontal face photos are very important so programmers and organizers could learn about each other. Make sure the photo doesn\\u2019t include any personal or sensitive information you woudn\\u2019t like others to see.\"), __jsx(Dropzone, {\n        accept: \"image/jpeg, image/png, image/gif\",\n        onDrop: this.onDrop.bind(this)\n      }, function (_ref2) {\n        var getRootProps = _ref2.getRootProps,\n            getInputProps = _ref2.getInputProps;\n        return __jsx(\"section\", null, __jsx(\"div\", getRootProps(), __jsx(\"input\", getInputProps()), __jsx(Button, {\n          transparent: true\n        }, \"Upload a photo\")));\n      }));\n    }\n  }]);\n\n  return RegAvatar;\n}(React.Component);\n\nexport { RegAvatar as default };","map":{"version":3,"sources":["D:/4/диплом/webapp/components/controls/Upload/RegAvatar.js"],"names":["React","Dropzone","AvatarEditor","UploadImg","IcAvatar","Text","Button","IconRotateRight","RegAvatar","props","state","image","editor","getImageScaledToCanvas","toBlob","blob","bind","data","img","toDataURL","rect","getCroppingRect","setState","preview","scale","width","height","borderRadius","e","target","value","allowZoomOut","checked","preventDefault","rotate","x","position","y","files","positiD","onCrop","onCropDefault","onCloseDefault","accepted","rejected","length","handleScale","console","log","fileError","defaultPreview","newAvatar","binary","atob","split","array","i","push","charCodeAt","Blob","Uint8Array","type","avatar","onLoadSuccess","profilePhotoURL","dropStyle","styleCanvas","ActionLink","document","getElementById","click","setEditorRef","handlePositionChange","handleSave","logCallback","textAlign","marginBottom","rotateRight","onDrop","getRootProps","getInputProps","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Dropzone from 'react-dropzone'\r\nimport AvatarEditor from 'react-avatar-editor'\r\n\r\n\r\nimport {UploadImg, IcAvatar} from '../../StyledComponents/Icon'\r\nimport {Text} from \"../../StyledComponents/Text\";\r\n\r\nimport './styles.css'\r\nimport {Button} from \"../Button/Button\";\r\nimport IconRotateRight from '../../../static/img/icon-rotate-right.png'\r\n\r\nexport default class RegAvatar extends React.Component {\r\n    getImage = () => {\r\n        if(this.state.image) {\r\n            this.editor.getImageScaledToCanvas().toBlob(function (blob) {\r\n                return blob;\r\n            }.bind(this), 'image/jpeg', 1);\r\n        }\r\n    }\r\n    handleSave = data => {\r\n        const img = this.editor.getImageScaledToCanvas().toDataURL()\r\n        const rect = this.editor.getCroppingRect()\r\n\r\n        this.setState({\r\n            preview: {\r\n                img,\r\n                rect,\r\n                scale: this.state.scale,\r\n                width: this.state.width,\r\n                height: this.state.height,\r\n                borderRadius: this.state.borderRadius\r\n            }\r\n        })\r\n    }\r\n    handleScale = e => {\r\n        const scale = parseFloat(e.target.value)\r\n        this.setState({ scale })\r\n    }\r\n    handleAllowZoomOut = ({ target: { checked: allowZoomOut } }) => {\r\n        this.setState({ allowZoomOut })\r\n    }\r\n    rotateLeft = e => {\r\n        e.preventDefault()\r\n\r\n        this.setState({\r\n            rotate: this.state.rotate - 90\r\n        })\r\n    }\r\n    rotateRight = e => {\r\n        e.preventDefault()\r\n        this.setState({\r\n            rotate: this.state.rotate + 90\r\n        })\r\n    }\r\n    handleBorderRadius = e => {\r\n        const borderRadius = parseInt(e.target.value)\r\n        this.setState({ borderRadius })\r\n    }\r\n    handleXPosition = e => {\r\n        const x = parseFloat(e.target.value)\r\n        this.setState({ position: { ...this.state.position, x } })\r\n    }\r\n    handleYPosition = e => {\r\n        const y = parseFloat(e.target.value)\r\n        this.setState({ position: { ...this.state.position, y } })\r\n    }\r\n    handleWidth = e => {\r\n        const width = parseInt(e.target.value)\r\n        this.setState({ width })\r\n    }\r\n    handleHeight = e => {\r\n        const height = parseInt(e.target.value)\r\n        this.setState({ height })\r\n    }\r\n    setEditorRef = editor => {\r\n        if (editor) this.editor = editor\r\n    }\r\n    handlePositionChange = position => {\r\n        this.setState({ position })\r\n    }\r\n    handleNewImage = e => {\r\n        this.setState({ image: e.target.files[0] })\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            allowZoomOut: false,\r\n            positiD: { x: 0.5, y: 0.5 },\r\n            scale: 1,\r\n            rotate: 0,\r\n            borderRadius: 256,\r\n            preview: null,\r\n            width: 512,\r\n            height: 512\r\n        };\r\n\r\n        this.onCrop = this.onCrop.bind(this)\r\n        this.onCropDefault = this.onCropDefault.bind(this)\r\n        this.onCloseDefault = this.onCloseDefault.bind(this)\r\n    }\r\n\r\n    onDrop(accepted, rejected) {\r\n        if (accepted.length) {\r\n            this.setState({image: accepted[0]});\r\n            this.handleScale({target:{value:'1.01'}})\r\n        }\r\n        if (rejected.length) {\r\n            console.log('rejected')\r\n            this.setState({fileError: 'The uploaded file seems to have incorrect format'})\r\n        }\r\n    }\r\n\r\n    onCropDefault(preview) {\r\n        this.setState({defaultPreview: preview, newAvatar: true})\r\n\r\n        let binary = atob(preview.split(',')[1]);\r\n        let array = [];\r\n        for(let i = 0; i < binary.length; i++) {\r\n            array.push(binary.charCodeAt(i));\r\n        }\r\n        let img =  new Blob([new Uint8Array(array)], {type: 'image/jpeg'});\r\n        this.setState({avatar: img})\r\n    }\r\n\r\n    onCrop(preview) {\r\n        this.setState({preview})\r\n    }\r\n\r\n    onCloseDefault() {\r\n        this.setState({defaultPreview: null, newAvatar: false, preview: null})\r\n    }\r\n\r\n    logCallback (e) {\r\n        if(e === 'onLoadSuccess' && this.props.onLoadSuccess) this.props.onLoadSuccess()\r\n    }\r\n\r\n    render() {\r\n        let {\r\n            profilePhotoURL\r\n        } = this.props\r\n        let image = this.state.image;\r\n\r\n        const dropStyle = {\r\n            'width': '100%',\r\n            'height': 'auto',\r\n            'margin': '0 auto',\r\n            'border': 'none',\r\n            'display':'table'\r\n        }\r\n\r\n        let styleCanvas = {\r\n            'width': '240px',\r\n            'height': '240px',\r\n        }\r\n\r\n        function ActionLink() {\r\n            document.getElementById('input_load_file_2').click();\r\n        }\r\n\r\n        return (\r\n            <React.Fragment>\r\n\r\n                {/* default state. No photo */}\r\n                {!image &&\r\n                <div className=\"shell-load-img-cart\">\r\n                    <div className=\"block-load-img\">\r\n                        <section className=\"section-wrap-upload\">\r\n                            {profilePhotoURL ?\r\n                                <img src={profilePhotoURL} alt='logo' />\r\n                                :\r\n                                <IcAvatar />\r\n                            }\r\n                        </section>\r\n                    </div>\r\n                </div>\r\n                }\r\n\r\n\r\n                {/*Image is chosen*/}\r\n                {image &&\r\n                <React.Fragment>\r\n                    <div className=\"wrap-canvas-avatar\">\r\n                        <AvatarEditor\r\n                            ref={this.setEditorRef}\r\n                            scale={parseFloat(this.state.scale)}\r\n                            width={this.state.width}\r\n                            height={this.state.height}\r\n                            position={this.state.position}\r\n                            onPositionChange={this.handlePositionChange}\r\n                            rotate={parseFloat(this.state.rotate)}\r\n                            borderRadius={this.state.borderRadius}\r\n                            onSave={this.handleSave}\r\n                            onLoadFailure={this.logCallback.bind(this, 'onLoadFailed')}\r\n                            onLoadSuccess={this.logCallback.bind(this, 'onLoadSuccess')}\r\n                            onImageReady={this.logCallback.bind(this, 'onImageReady')}\r\n                            onImageLoad={this.logCallback.bind(this, 'onImageLoad')}\r\n                            onDropFile={this.logCallback.bind(this, 'onDropFile')}\r\n                            color={[0, 0, 0, 0.8]}\r\n                            style={styleCanvas}\r\n                            image={this.state.image || UploadImg}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className={'zoom-inp'}>\r\n                        <input\r\n                            name='scale'\r\n                            type='range'\r\n                            onChange={this.handleScale}\r\n                            min={this.state.allowZoomOut ? '0.1' : '1'}\r\n                            max='4'\r\n                            step='0.01'\r\n                            defaultValue='1'\r\n                        />\r\n                    </div>\r\n\r\n\r\n                    <div style={{textAlign: 'center', marginBottom: '10px'}}>\r\n                        <img style={{width: '15px'}} src={IconRotateRight} alt=\"rotate\" onClick={(e) => this.rotateRight(e)}/>\r\n                    </div>\r\n                    {/*<div onClick={(e) => this.rotateRight(e)}>Right</div>*/}\r\n                </React.Fragment>\r\n                }\r\n\r\n                <Text fz={14} mb={30} grey6 >\r\n                    Clear high-quality frontal face photos are very\r\n                    important so programmers and organizers could learn about each other.\r\n                    Make sure the photo doesn’t include any personal or sensitive information you woudn’t like others to see.\r\n                </Text>\r\n\r\n                <Dropzone accept=\"image/jpeg, image/png, image/gif\" onDrop={this.onDrop.bind(this)}>\r\n                    {({getRootProps, getInputProps}) => (\r\n                        <section>\r\n                            <div {...getRootProps()}>\r\n                                <input {...getInputProps()} />\r\n                                <Button transparent >Upload a photo</Button>\r\n                            </div>\r\n                        </section>\r\n                    )}\r\n                </Dropzone>\r\n\r\n            </React.Fragment>\r\n\r\n        );\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}