{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport dynamic from 'next/dynamic';\nimport Link from \"next/link\";\nimport Router, { useRouter } from 'next/router';\nimport Header from \"../../../components/Header/Header\";\nimport { HeaderChat } from \"../../../components/Inbox/styledComponent\";\nimport Message from \"../../../components/Inbox/Message\";\nimport { Text } from \"../../../components/StyledComponents/Text\";\nimport { apiGetChatById, apiDeclineBooking, apiPreApprove } from \"../../../actions/api\";\nimport { MainContext } from \"../../../components/contextProviders/MainContext\";\nimport { Button } from \"../../../components/controls/Button/Button\";\nimport { Footer } from \"../../../components/Layouts/styledLayouts\";\nimport { showNotification } from '../../../utils/notification';\nimport { Wrapper } from \"../../../components/StyledComponents/Wrapper\";\nimport { Title, SubTitle } from \"../../../components/Booking/styledComponent\";\nimport { Divider } from \"../../../components/StyledComponents/Divider\";\nimport arrowBack from \"../../../static/img/arrow-back.svg\";\nexport default (() => {\n  const router = useRouter();\n  const {\n    id\n  } = router.query;\n  const {\n    me\n  } = useContext(MainContext);\n  const {\n    0: booking,\n    1: setBooking\n  } = useState({});\n  const {\n    0: offer,\n    1: setOffer\n  } = useState({});\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(true);\n  const {\n    0: loadingPre,\n    1: setLoadingPre\n  } = useState(false);\n  const messagesEnd = useRef(null);\n  const myRef = useRef(null);\n  useEffect(() => {\n    console.log('id effect', id);\n\n    if (id) {\n      apiGetChatById(id).then(res => {\n        setBooking(res.data);\n        if (res.data.offerId) setOffer(res.data.offerId);\n        setLoading(false);\n      }).catch(e => {\n        setLoading(false);\n      });\n    }\n  }, [id]);\n\n  const preApprove = () => {\n    let data = {\n      bookingId: id\n    };\n    setLoadingPre(true);\n    apiPreApprove(offer.id, data).then(res => {\n      setLoadingPre(false);\n      showNotification('info', 'offer is pre approved');\n      Router.push('/inbox/[id]/booking', `/inbox/${booking.id}/booking`, {\n        shallow: true\n      });\n    }).catch(e => {\n      setLoadingPre(false);\n    });\n  };\n\n  const handleDecline = () => {\n    let data = {\n      bookingId: id\n    };\n    setLoadingPre(true);\n    apiDeclineBooking(offer.id, data).then(res => {\n      setLoadingPre(false);\n      Router.push('/inbox/[id]/booking', `/inbox/${booking.id}/booking`, {\n        shallow: true\n      });\n    }).catch(e => {\n      setLoadingPre(false);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(HeaderChat, null, __jsx(Link, {\n    href: \"/inbox/[id]/booking\",\n    as: `/inbox/${booking.id}/booking`,\n    shallow: true\n  }, __jsx(\"img\", {\n    src: arrowBack,\n    alt: \"\"\n  })), __jsx(\"div\", null)), !loading ? __jsx(Wrapper, {\n    p: 17\n  }, __jsx(Title, null, offer.name), __jsx(SubTitle, null, offer.subCategory.category), __jsx(Text, {\n    grey: true,\n    fz: 16\n  }, \"Organizer: \", me.firstName, \" \", me.lastName), __jsx(Divider, {\n    mt: 15,\n    mb: 15,\n    full: true,\n    grey: true\n  }), __jsx(Text, {\n    grey: true,\n    fz: 16\n  }, \"Pre-approve this inquiry if Friday 9th September 10:00 - 14:00 works for you& These date end time will stay availible until Client Name or another books your programmer.\", __jsx(\"br\", null), __jsx(\"br\", null), \"Respond within 23:58:31 to maintain your response rate.\"), __jsx(Button, {\n    mt: 20,\n    mb: 10,\n    blue: true,\n    onClick: preApprove,\n    loading: loadingPre\n  }, \"Pre-approve\"), __jsx(Button, {\n    onClick: handleDecline\n  }, \"Decline\"), __jsx(Text, {\n    mt: 10,\n    fz: 16,\n    grey: true\n  }, \"Protected by the Programmerbooking Talen Guarantie and Programmer Protected inshurance\")) : __jsx(React.Fragment, null, \"Loading...\"));\n});","map":{"version":3,"sources":["D:/4/диплом/webapp — копия/pages/booking/[id]/index.js"],"names":["React","useState","useContext","useEffect","useRef","dynamic","Link","Router","useRouter","Header","HeaderChat","Message","Text","apiGetChatById","apiDeclineBooking","apiPreApprove","MainContext","Button","Footer","showNotification","Wrapper","Title","SubTitle","Divider","arrowBack","router","id","query","me","booking","setBooking","offer","setOffer","loading","setLoading","loadingPre","setLoadingPre","messagesEnd","myRef","console","log","then","res","data","offerId","catch","e","preApprove","bookingId","push","shallow","handleDecline","name","subCategory","category","firstName","lastName"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect, useRef } from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport Link from \"next/link\";\r\n\r\nimport Router, { useRouter } from 'next/router'\r\nimport Header from \"../../../components/Header/Header\";\r\nimport {HeaderChat} from \"../../../components/Inbox/styledComponent\"\r\nimport Message from \"../../../components/Inbox/Message\"\r\nimport {Text} from \"../../../components/StyledComponents/Text\"\r\nimport {apiGetChatById, apiDeclineBooking, apiPreApprove} from \"../../../actions/api\";\r\nimport {MainContext} from \"../../../components/contextProviders/MainContext\";\r\nimport {Button} from \"../../../components/controls/Button/Button\";\r\nimport {Footer} from \"../../../components/Layouts/styledLayouts\";\r\nimport {showNotification} from '../../../utils/notification'\r\nimport {Wrapper} from \"../../../components/StyledComponents/Wrapper\";\r\nimport {Title, SubTitle} from \"../../../components/Booking/styledComponent\"\r\nimport {Divider} from \"../../../components/StyledComponents/Divider\";\r\nimport arrowBack from \"../../../static/img/arrow-back.svg\"\r\n\r\nexport default  () => {\r\n    const router = useRouter()\r\n    const { id } = router.query\r\n    const {me} = useContext(MainContext)\r\n    const [booking, setBooking] = useState({})\r\n    const [offer, setOffer] = useState({})\r\n    const [loading, setLoading] = useState(true)\r\n    const [loadingPre, setLoadingPre] = useState(false)\r\n    const messagesEnd = useRef(null);\r\n    const myRef = useRef(null)\r\n\r\n    useEffect(() => {\r\n        console.log('id effect', id)\r\n        if(id) {\r\n            apiGetChatById(id)\r\n                .then(res => {\r\n                    setBooking(res.data)\r\n                    if(res.data.offerId) setOffer(res.data.offerId)\r\n                    setLoading(false)\r\n                })\r\n                .catch(e => {\r\n                    setLoading(false)\r\n                })\r\n        }\r\n    }, [id]);\r\n\r\n\r\n    const preApprove = () => {\r\n        let data = {\r\n            bookingId: id\r\n        }\r\n        setLoadingPre(true)\r\n        apiPreApprove(offer.id, data)\r\n            .then(res => {\r\n                setLoadingPre(false)\r\n                showNotification('info', 'offer is pre approved')\r\n                Router.push('/inbox/[id]/booking', `/inbox/${booking.id}/booking`, {shallow: true})\r\n            })\r\n            .catch(e => {\r\n                setLoadingPre(false)\r\n            })\r\n    }\r\n\r\n    const handleDecline = () => {\r\n        let data = {\r\n            bookingId: id\r\n        }\r\n        setLoadingPre(true)\r\n        apiDeclineBooking(offer.id, data)\r\n            .then(res => {\r\n                setLoadingPre(false)\r\n                Router.push('/inbox/[id]/booking', `/inbox/${booking.id}/booking`, {shallow: true})\r\n            })\r\n            .catch(e => {\r\n                setLoadingPre(false)\r\n            })\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            {/*<Header isProfile/>*/}\r\n\r\n            <HeaderChat>\r\n                <Link href=\"/inbox/[id]/booking\" as={`/inbox/${booking.id}/booking`} shallow>\r\n                    <img src={arrowBack} alt=\"\"/>\r\n                </Link>\r\n                <div></div>\r\n            </HeaderChat>\r\n            {!loading ?\r\n                <Wrapper p={17}>\r\n                    <Title>{offer.name}</Title>\r\n                    <SubTitle>{offer.subCategory.category}</SubTitle>\r\n                    {/*<Text mt={'5px'} mb={'5px'} fz={20} grey4a >Name - The Pirates of Arabia Live action</Text>*/}\r\n                    {/*<Text grey fz={16} >40 minutes  |   1 Act  |  AED 500</Text>*/}\r\n                    <Text grey fz={16} >Organizer: {me.firstName} {me.lastName}</Text>\r\n                    <Divider mt={15} mb={15} full grey />\r\n                    <Text grey fz={16}>\r\n                        Pre-approve this inquiry if Friday 9th September 10:00 - 14:00\r\n                        works for you& These date end time will stay availible until Client Name or another books your programmer.\r\n                        <br/><br/>\r\n                        Respond within 23:58:31 to maintain your response rate.\r\n                    </Text>\r\n                    <Button mt={20} mb={10} blue onClick={preApprove} loading={loadingPre}>Pre-approve</Button>\r\n                    <Button onClick={handleDecline} >Decline</Button>\r\n                    <Text mt={10} fz={16} grey>Protected by the Programmerbooking Talen Guarantie and Programmer Protected inshurance</Text>\r\n                </Wrapper>\r\n                :\r\n                <>Loading...</>\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}