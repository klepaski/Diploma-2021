{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  @media \", \" {\\n    \", \" {\\n      padding-top: 20px;\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { Router } from '../../routes';\nimport { MainContext } from '../../components/contextProviders/MainContext';\nimport { CheckLabel, Footer, Label, Label2, TipWrapper, TipWrapper2, Title, WhoCard } from '../../components/Layouts/styledLayouts';\nimport styled, { css } from 'styled-components';\nimport { device } from '../../lib/mediaDevice';\nimport { Wrapper, WrapperHeight } from '../../components/StyledComponents/Wrapper';\nimport { Button } from '../../components/controls/Button/Button';\nimport Header from '../../components/Header/Header';\nimport { login, withAuthSync } from '../../utils/auth';\nimport Category from '../../components/Offer/creation/Category';\nimport YourMemo from '../../components/Offer/creation/YourMemo';\nimport Start from '../../components/Offer/creation/Start';\nimport Description from '../../components/Offer/creation/Description';\nimport PerfectFor from '../../components/Offer/creation/PerfectFor';\nimport People from '../../components/Offer/creation/People';\nimport { apiLoginUser, apiCreateOffer, apiGetEventTypes, apiSendInvitatons, apiGetProgrammerCategories } from '../../actions/api';\nimport { showNotification } from '../../utils/notification';\nimport useUserInfo from '../../hooks/useUserInfo';\nimport { ContainerDesktop, FooterDesktop } from '../../components/StyledComponents/Grid';\n\nvar Create = function Create() {\n  var _useState = useState(1),\n      step = _useState[0],\n      setStep = _useState[1];\n\n  var _useState2 = useState([]),\n      listEventTypes = _useState2[0],\n      setListEventTypes = _useState2[1];\n\n  var _useState3 = useState([]),\n      listCategories = _useState3[0],\n      setListCategories = _useState3[1];\n\n  var _useState4 = useState(false),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var defaultOffer = {\n    name: '',\n    summary: '',\n    description: '',\n    descriptionWillDone: '',\n    descriptionWillProvide: '',\n    descriptionRequirements: '',\n    descriptionNote: '',\n    type: [],\n    numberOfPeople: '',\n    country: [],\n    category: {},\n    subCategory: {},\n    listEmails: []\n  };\n\n  var _useState5 = useState(defaultOffer),\n      offer = _useState5[0],\n      setOffer = _useState5[1];\n\n  useEffect(function () {\n    var getListEventTypes = function getListEventTypes() {\n      var res;\n      return _regeneratorRuntime.async(function getListEventTypes$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(apiGetEventTypes());\n\n            case 2:\n              res = _context.sent;\n              setListEventTypes(res.data);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    };\n\n    var getCategories = function getCategories() {\n      var res;\n      return _regeneratorRuntime.async(function getCategories$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(apiGetProgrammerCategories());\n\n            case 2:\n              res = _context2.sent;\n              setListCategories(res.data);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      });\n    };\n\n    getCategories();\n    getListEventTypes();\n  }, []);\n  useEffect(function () {\n    window.scrollTo(0, 0);\n  }, [step]);\n\n  var handleBack = function handleBack() {\n    setStep(step - 1);\n  };\n\n  var handleNext = function handleNext() {\n    if (step === 6) {\n      createOffer();\n    } else {\n      setStep(step + 1);\n    }\n  };\n\n  var onChange = function onChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value,\n        required = _e$target.required;\n    if (name === 'numberOfPeople') value = Number(value);\n\n    if (name == 'description' || name == 'descriptionWillDone' || name == 'descriptionWillProvide' || name == 'descriptionRequirements' || name == 'descriptionNote') {\n      value = value.slice(0, 500);\n    }\n\n    if (name == 'name') {\n      value = value.slice(0, 200);\n    }\n\n    if (name == 'summary') {\n      value = value.slice(0, 300);\n    }\n\n    setOffer(function (offer) {\n      return _objectSpread({}, offer, _defineProperty({}, name, value));\n    }); // let error = validate(name, value, required)\n    // setErorrs(errors => ({...errors, [name]: error}))\n  };\n\n  var createOffer = function createOffer() {\n    setLoading(true);\n\n    var clone = _Object$assign({}, offer);\n\n    clone.category = offer.category.id;\n    clone.subCategory = offer.subCategory ? offer.subCategory.id : '';\n    clone.country = offer.country ? offer.country.map(function (item) {\n      return item.value;\n    }).join(', ') : '';\n    apiCreateOffer(clone).then(function _callee(res) {\n      var obj;\n      return _regeneratorRuntime.async(function _callee$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              // let inv = await sendInvitations(res.data.id, offer.listEmails);\n              obj = {\n                emails: offer.listEmails\n              };\n\n              if (offer.listEmails.length) {\n                apiSendInvitatons(res.data.id, obj).then(function () {\n                  Router.push(\"/offers/\".concat(res.data.id, \"/params\"));\n                })[\"catch\"](function (err) {\n                  showNotification('error', err);\n                  Router.push(\"/offers/\".concat(res.data.id, \"/params\"));\n                });\n              } else {\n                Router.push(\"/offers/\".concat(res.data.id, \"/params\"));\n              }\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      });\n    })[\"catch\"](function (err) {\n      setLoading(false);\n      showNotification('error', err);\n    });\n  };\n\n  var disabled = step == 3 && !offer.name;\n  return __jsx(CreateBox, null, __jsx(Header, {\n    isReg: true,\n    hiddeSave: true\n  }), __jsx(Wrapper, {\n    p: 15,\n    pt: 35\n  }, __jsx(ContainerDesktop, {\n    isOffer: true\n  }, __jsx(WrapperHeight, null, step === 1 && __jsx(Category, {\n    offer: offer,\n    listCategories: listCategories,\n    onChange: onChange,\n    handleNext: handleNext\n  }), step === 2 && __jsx(YourMemo, {\n    offer: offer\n  }), step === 3 && __jsx(Start, {\n    offer: offer,\n    onChange: onChange\n  }), step === 4 && __jsx(Description, {\n    offer: offer,\n    onChange: onChange\n  }), step === 5 && __jsx(PerfectFor, {\n    listEventTypes: listEventTypes,\n    offer: offer,\n    onChange: onChange\n  }), step === 6 && __jsx(People, {\n    offer: offer,\n    onChange: onChange\n  }))), step != 1 && __jsx(FooterDesktop, null, __jsx(Footer, {\n    mt: 50,\n    flexEnd: step === 1\n  }, step !== 1 && __jsx(Button, {\n    onClick: handleBack,\n    disabled: step === 6 && loading\n  }, \"Back\"), __jsx(Button, {\n    blue: true,\n    onClick: handleNext,\n    disabled: disabled,\n    loading: loading\n  }, \"Next\")))));\n};\n\nexport default withAuthSync(Create);\nvar CreateBox = styled.div(_templateObject(), device.laptopDesktop, Wrapper);","map":{"version":3,"sources":["D:/4/диплом/webapp/pages/offers/create.js"],"names":["React","useState","useContext","useEffect","PropTypes","Router","MainContext","CheckLabel","Footer","Label","Label2","TipWrapper","TipWrapper2","Title","WhoCard","styled","css","device","Wrapper","WrapperHeight","Button","Header","login","withAuthSync","Category","YourMemo","Start","Description","PerfectFor","People","apiLoginUser","apiCreateOffer","apiGetEventTypes","apiSendInvitatons","apiGetProgrammerCategories","showNotification","useUserInfo","ContainerDesktop","FooterDesktop","Create","step","setStep","listEventTypes","setListEventTypes","listCategories","setListCategories","loading","setLoading","defaultOffer","name","summary","description","descriptionWillDone","descriptionWillProvide","descriptionRequirements","descriptionNote","type","numberOfPeople","country","category","subCategory","listEmails","offer","setOffer","getListEventTypes","res","data","getCategories","window","scrollTo","handleBack","handleNext","createOffer","onChange","e","target","value","required","Number","slice","clone","id","map","item","join","then","obj","emails","length","push","err","disabled","CreateBox","div","laptopDesktop"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { Router } from '../../routes'\r\nimport { MainContext } from '../../components/contextProviders/MainContext'\r\nimport {\r\n  CheckLabel,\r\n  Footer,\r\n  Label,\r\n  Label2,\r\n  TipWrapper,\r\n  TipWrapper2,\r\n  Title,\r\n  WhoCard,\r\n} from '../../components/Layouts/styledLayouts'\r\nimport styled, { css } from 'styled-components'\r\nimport { device } from '../../lib/mediaDevice'\r\nimport { Wrapper, WrapperHeight } from '../../components/StyledComponents/Wrapper'\r\nimport { Button } from '../../components/controls/Button/Button'\r\nimport Header from '../../components/Header/Header'\r\nimport { login, withAuthSync } from '../../utils/auth'\r\nimport Category from '../../components/Offer/creation/Category'\r\nimport YourMemo from '../../components/Offer/creation/YourMemo'\r\nimport Start from '../../components/Offer/creation/Start'\r\nimport Description from '../../components/Offer/creation/Description'\r\nimport PerfectFor from '../../components/Offer/creation/PerfectFor'\r\nimport People from '../../components/Offer/creation/People'\r\nimport {\r\n  apiLoginUser,\r\n  apiCreateOffer,\r\n  apiGetEventTypes,\r\n  apiSendInvitatons,\r\n  apiGetProgrammerCategories,\r\n} from '../../actions/api'\r\nimport { showNotification } from '../../utils/notification'\r\nimport useUserInfo from '../../hooks/useUserInfo'\r\nimport { ContainerDesktop, FooterDesktop } from '../../components/StyledComponents/Grid'\r\n\r\nconst Create = () => {\r\n  const [step, setStep] = useState(1)\r\n  const [listEventTypes, setListEventTypes] = useState([])\r\n  const [listCategories, setListCategories] = useState([])\r\n  const [loading, setLoading] = useState(false)\r\n  let defaultOffer = {\r\n    name: '',\r\n    summary: '',\r\n    description: '',\r\n    descriptionWillDone: '',\r\n    descriptionWillProvide: '',\r\n    descriptionRequirements: '',\r\n    descriptionNote: '',\r\n    type: [],\r\n    numberOfPeople: '',\r\n    country: [],\r\n    category: {},\r\n    subCategory: {},\r\n    listEmails: [],\r\n  }\r\n  const [offer, setOffer] = useState(defaultOffer)\r\n\r\n  useEffect(() => {\r\n    let getListEventTypes = async () => {\r\n      const res = await apiGetEventTypes()\r\n      setListEventTypes(res.data)\r\n    }\r\n    const getCategories = async () => {\r\n      const res = await apiGetProgrammerCategories()\r\n      setListCategories(res.data)\r\n    }\r\n    getCategories()\r\n    getListEventTypes()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0)\r\n  }, [step])\r\n\r\n  const handleBack = () => {\r\n    setStep(step - 1)\r\n  }\r\n  const handleNext = () => {\r\n    if (step === 6) {\r\n      createOffer()\r\n    } else {\r\n      setStep(step + 1)\r\n    }\r\n  }\r\n\r\n  const onChange = (e) => {\r\n    let { name, value, required } = e.target\r\n\r\n    if (name === 'numberOfPeople') value = Number(value)\r\n    if (\r\n      name == 'description' ||\r\n      name == 'descriptionWillDone' ||\r\n      name == 'descriptionWillProvide' ||\r\n      name == 'descriptionRequirements' ||\r\n      name == 'descriptionNote'\r\n    ) {\r\n      value = value.slice(0, 500)\r\n    }\r\n\r\n    if (name == 'name') {\r\n      value = value.slice(0, 200)\r\n    }\r\n    if (name == 'summary') {\r\n      value = value.slice(0, 300)\r\n    }\r\n\r\n\r\n    setOffer((offer) => ({ ...offer, [name]: value }))\r\n    // let error = validate(name, value, required)\r\n    // setErorrs(errors => ({...errors, [name]: error}))\r\n  }\r\n\r\n  const createOffer = () => {\r\n    setLoading(true)\r\n    let clone = Object.assign({}, offer)\r\n    clone.category = offer.category.id\r\n    clone.subCategory = offer.subCategory ? offer.subCategory.id : ''\r\n    clone.country = offer.country ? offer.country.map((item) => item.value).join(', ') : ''\r\n\r\n    apiCreateOffer(clone)\r\n      .then(async (res) => {\r\n        // let inv = await sendInvitations(res.data.id, offer.listEmails);\r\n        let obj = { emails: offer.listEmails }\r\n        if (offer.listEmails.length) {\r\n          apiSendInvitatons(res.data.id, obj)\r\n            .then(() => {\r\n              Router.push(`/offers/${res.data.id}/params`)\r\n            })\r\n            .catch((err) => {\r\n              showNotification('error', err)\r\n              Router.push(`/offers/${res.data.id}/params`)\r\n            })\r\n        } else {\r\n          Router.push(`/offers/${res.data.id}/params`)\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        setLoading(false)\r\n        showNotification('error', err)\r\n      })\r\n  }\r\n\r\n  let disabled = step == 3 && !offer.name\r\n\r\n  return (\r\n    <CreateBox>\r\n      <Header isReg hiddeSave />\r\n      <Wrapper p={15} pt={35}>\r\n        <ContainerDesktop isOffer>\r\n          <WrapperHeight>\r\n            {step === 1 && (\r\n              <Category\r\n                offer={offer}\r\n                listCategories={listCategories}\r\n                onChange={onChange}\r\n                handleNext={handleNext}\r\n              />\r\n            )}\r\n            {step === 2 && <YourMemo offer={offer} />}\r\n            {step === 3 && <Start offer={offer} onChange={onChange} />}\r\n            {step === 4 && <Description offer={offer} onChange={onChange} />}\r\n            {step === 5 && (\r\n              <PerfectFor listEventTypes={listEventTypes} offer={offer} onChange={onChange} />\r\n            )}\r\n            {step === 6 && <People offer={offer} onChange={onChange} />}\r\n          </WrapperHeight>\r\n        </ContainerDesktop>\r\n\r\n        {step != 1 && (\r\n        <FooterDesktop>\r\n            <Footer mt={50} flexEnd={step === 1}>\r\n              {step !== 1 && (\r\n                <Button onClick={handleBack} disabled={step === 6 && loading}>\r\n                  Back\r\n                </Button>\r\n              )}\r\n              <Button blue onClick={handleNext} disabled={disabled} loading={loading}>\r\n                Next\r\n              </Button>\r\n            </Footer>\r\n        </FooterDesktop>\r\n        )}\r\n      </Wrapper>\r\n    </CreateBox>\r\n  )\r\n}\r\n\r\nexport default withAuthSync(Create)\r\n\r\nconst CreateBox = styled.div`\r\n  @media ${device.laptopDesktop} {\r\n    ${Wrapper} {\r\n      padding-top: 20px;\r\n    }\r\n  }\r\n`\r\n"]},"metadata":{},"sourceType":"module"}