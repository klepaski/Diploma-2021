{"ast":null,"code":"import _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport Router from 'next/router';\nimport { apiGetMe } from '../../actions/api';\nimport cookie from \"js-cookie\";\nvar token = cookie.get('token');\nvar MainContext = React.createContext({});\nvar MainConsumer = MainContext.Consumer;\n/* Then create a provider Component */\n\nvar MainProvider =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MainProvider, _Component);\n\n  function MainProvider() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MainProvider);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MainProvider)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"getMe\", function () {\n      apiGetMe().then(function (res) {\n        _this.setState({\n          me: res.data,\n          checkedMe: true\n        });\n      })[\"catch\"](function () {\n        Router.push('/login');\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setMe\", function (me) {\n      var clone = _Object$assign({}, me);\n\n      _this.setState({\n        me: me\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setOffer\", function (offer) {\n      _this.setState({\n        offer: _Object$assign({}, offer)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      me: {},\n      offer: {\n        categoryOptions: []\n      },\n      checkedMe: false,\n      setMe: _this.setMe,\n      setOffer: _this.setOffer,\n      listOffers: []\n    });\n\n    return _this;\n  }\n\n  _createClass(MainProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (token) {\n        this.getMe();\n      } else {\n        this.setState({\n          checkedMe: true\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(MainContext.Provider, {\n        value: this.state\n      }, this.props.children);\n    }\n  }]);\n\n  return MainProvider;\n}(Component); // MainProvider.getInitialProps = async ({ req }) => {\n//     const node_env = process.env.NODE_ENV\n//     console.log('test', node_env)\n//     const host =  req.headers.host\n//     return { node_env }\n// }\n\n\nexport default MainProvider;\nexport { MainConsumer, MainContext };","map":{"version":3,"sources":["D:/git/webapp3/webapp/components/contextProviders/MainContext.js"],"names":["React","Component","Router","apiGetMe","cookie","token","get","MainContext","createContext","MainConsumer","Consumer","MainProvider","then","res","setState","me","data","checkedMe","push","clone","offer","categoryOptions","setMe","setOffer","listOffers","getMe","state","props","children"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,SAAQC,QAAR,QAAuB,mBAAvB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,IAAIC,KAAK,GAAGD,MAAM,CAACE,GAAP,CAAW,OAAX,CAAZ;AAEA,IAAMC,WAAW,GAAGP,KAAK,CAACQ,aAAN,CAAoB,EAApB,CAApB;AACA,IAAMC,YAAY,GAAGF,WAAW,CAACG,QAAjC;AAEA;;IACMC,Y;;;;;;;;;;;;;;;;;;4DACM,YAAM;AACVR,MAAAA,QAAQ,GACHS,IADL,CACU,UAACC,GAAD,EAAS;AACX,cAAKC,QAAL,CAAc;AAACC,UAAAA,EAAE,EAAEF,GAAG,CAACG,IAAT;AAAeC,UAAAA,SAAS,EAAE;AAA1B,SAAd;AACH,OAHL,WAIW,YAAM;AACTf,QAAAA,MAAM,CAACgB,IAAP,CAAY,QAAZ;AACH,OANL;AAQH,K;;4DAEO,UAAAH,EAAE,EAAI;AACV,UAAII,KAAK,GAAG,eAAc,EAAd,EAAkBJ,EAAlB,CAAZ;;AACA,YAAKD,QAAL,CAAc;AAACC,QAAAA,EAAE,EAAEA;AAAL,OAAd;AACH,K;;+DAEU,UAAAK,KAAK,EAAI;AAChB,YAAKN,QAAL,CAAc;AAACM,QAAAA,KAAK,EAAE,eAAc,EAAd,EAAkBA,KAAlB;AAAR,OAAd;AACH,K;;4DAGO;AACJL,MAAAA,EAAE,EAAE,EADA;AAEJK,MAAAA,KAAK,EAAE;AACHC,QAAAA,eAAe,EAAE;AADd,OAFH;AAKJJ,MAAAA,SAAS,EAAE,KALP;AAMJK,MAAAA,KAAK,EAAE,MAAKA,KANR;AAOJC,MAAAA,QAAQ,EAAE,MAAKA,QAPX;AAQJC,MAAAA,UAAU,EAAE;AARR,K;;;;;;;wCAWY;AAChB,UAAGnB,KAAH,EAAU;AACN,aAAKoB,KAAL;AACH,OAFD,MAEO;AACH,aAAKX,QAAL,CAAc;AAACG,UAAAA,SAAS,EAAE;AAAZ,SAAd;AACH;AACJ;;;6BAIS;AACN,aACI,MAAC,WAAD,CAAa,QAAb;AAAsB,QAAA,KAAK,EAAE,KAAKS;AAAlC,SACK,KAAKC,KAAL,CAAWC,QADhB,CADJ;AAKH;;;;EAjDsB3B,S,GAoD3B;AACA;AACA;AACA;AACA;AACA;;;AAEA,eAAeU,YAAf;AACA,SAAQF,YAAR,EAAsBF,WAAtB","sourcesContent":["import React, { Component } from 'react'\r\nimport Router from 'next/router'\r\n\r\nimport {apiGetMe} from '../../actions/api'\r\nimport cookie from \"js-cookie\";\r\nlet token = cookie.get('token')\r\n\r\nconst MainContext = React.createContext({})\r\nconst MainConsumer = MainContext.Consumer\r\n\r\n/* Then create a provider Component */\r\nclass MainProvider extends Component {\r\n    getMe = () => {\r\n        apiGetMe()\r\n            .then((res) => {\r\n                this.setState({me: res.data, checkedMe: true});\r\n            })\r\n            .catch(() => {\r\n                Router.push('/login')\r\n            });\r\n\r\n    };\r\n\r\n    setMe = me => {\r\n        let clone = Object.assign({}, me);\r\n        this.setState({me: me})\r\n    }\r\n\r\n    setOffer = offer => {\r\n        this.setState({offer: Object.assign({}, offer)})\r\n    }\r\n\r\n\r\n    state = {\r\n        me: {},\r\n        offer: {\r\n            categoryOptions: []\r\n        },\r\n        checkedMe: false,\r\n        setMe: this.setMe,\r\n        setOffer: this.setOffer,\r\n        listOffers: []\r\n    }\r\n\r\n    componentDidMount() {\r\n        if(token) {\r\n            this.getMe()\r\n        } else {\r\n            this.setState({checkedMe: true})\r\n        }\r\n    }\r\n\r\n\r\n\r\n    render () {\r\n        return (\r\n            <MainContext.Provider value={this.state} >\r\n                {this.props.children}\r\n            </MainContext.Provider>\r\n        )\r\n    }\r\n}\r\n\r\n// MainProvider.getInitialProps = async ({ req }) => {\r\n//     const node_env = process.env.NODE_ENV\r\n//     console.log('test', node_env)\r\n//     const host =  req.headers.host\r\n//     return { node_env }\r\n// }\r\n\r\nexport default MainProvider\r\nexport {MainConsumer, MainContext}\r\n\r\n"]},"metadata":{},"sourceType":"module"}