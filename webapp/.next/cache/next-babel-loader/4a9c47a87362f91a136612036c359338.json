{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport dynamic from 'next/dynamic';\nimport moment from 'moment';\nimport Link from \"next/link\";\nimport Router, { useRouter } from 'next/router';\nimport { useAction, useAtom } from \"@reatom/react\";\nimport { modifyToBr } from '../../../utils/utils';\nimport { withReatom } from \"../../../lib/withReatom\";\nimport Header from \"../../../components/Header/Header\";\nimport { GalleryOffer } from \"../../../components/Gallery/GalleryOffer\";\nimport { Video } from \"../../../components/Gallery/Video\";\nimport { apiGetChatById, apiSendReview } from \"../../../actions/api\";\nimport { Text, LabelText } from \"../../../components/StyledComponents/Text\";\nimport { FlexBlock } from \"../../../components/StyledComponents/FlexBlock\";\nimport { AvatarOffer } from \"../../../components/Profile/styledProfileOffer\";\nimport { Divider } from \"../../../components/StyledComponents/Divider\";\nimport { Button, ButtonMinHeight } from \"../../../components/controls/Button/Button\";\nimport { Title } from \"../../../components/Layouts/styledLayouts\";\nimport { Wrapper } from \"../../../components/StyledComponents/Wrapper\";\nimport { showNotification } from \"../../../utils/notification\";\nimport { MainContext } from \"../../../components/contextProviders/MainContext\";\nimport useUserInfo from '../../../hooks/useUserInfo';\nimport OfferCardItem from \"../../../components/Offer/cards/OfferCardItem\";\nimport { TextArea } from \"../../../components/controls/Input/Input\";\nvar Calendar = dynamic(function () {\n  return import('../../../components/controls/Calendar/Calendar');\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../../../components/controls/Calendar/Calendar')];\n    },\n    modules: ['../../../components/controls/Calendar/Calendar']\n  }\n});\nvar CalendarAirbnb = dynamic(function () {\n  return import('../../../components/controls/Calendar/CalendarAirbnb');\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../../../components/controls/Calendar/CalendarAirbnb')];\n    },\n    modules: ['../../../components/controls/Calendar/CalendarAirbnb']\n  }\n});\n\nvar OfferPage = function OfferPage() {\n  var router = useRouter();\n\n  var _useContext = useContext(MainContext),\n      me = _useContext.me;\n\n  var id = router.query.id;\n\n  var _useState = useState({}),\n      offer = _useState[0],\n      setOffer = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(''),\n      review = _useState3[0],\n      setReview = _useState3[1];\n\n  useEffect(function () {\n    console.log('id effect', id);\n\n    if (id) {\n      apiGetChatById(id).then(function (res) {\n        if (res.data.offerId) setOffer(res.data.offerId);\n      })[\"catch\"](function (e) {});\n    }\n  }, [id]);\n\n  var onChange = function onChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setReview(value);\n  };\n\n  var handleSendReview = function handleSendReview() {\n    setLoading(true);\n    apiSendReview(id, {\n      text: review\n    }).then(function (res) {\n      setReview('');\n      showNotification('info', 'Review was sent successfully');\n      Router.push('/offers/[id]', \"/offers/\".concat(offer.id), {\n        shallow: true\n      });\n      setLoading(false);\n    })[\"catch\"](function (e) {\n      setLoading(false);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isProfile: true\n  }), offer.id ? __jsx(React.Fragment, null, __jsx(Wrapper, {\n    pl: 18,\n    pr: 18,\n    pb: 80\n  }, __jsx(Text, {\n    mt: 10,\n    fz: 20\n  }, \"Leave review about offer\"), __jsx(\"div\", {\n    className: \"review-wrapper-offer\"\n  }, __jsx(OfferCardItem, {\n    offer: offer\n  })), __jsx(\"div\", {\n    className: \"review-wrapper-form\"\n  }, __jsx(TextArea, {\n    name: \"review\",\n    value: review,\n    onChange: onChange,\n    height: 90,\n    placeholder: \"Review\"\n  }), __jsx(Button, {\n    mt: 20,\n    mb: 10,\n    green: true,\n    loading: loading,\n    onClick: handleSendReview\n  }, \"Send review\")))) : __jsx(React.Fragment, null, \"Loading...\"));\n};\n\nexport default withReatom(OfferPage);","map":{"version":3,"sources":["D:/4/диплом/webapp — копия/pages/booking/[id]/review.js"],"names":["React","useState","useContext","useEffect","dynamic","moment","Link","Router","useRouter","useAction","useAtom","modifyToBr","withReatom","Header","GalleryOffer","Video","apiGetChatById","apiSendReview","Text","LabelText","FlexBlock","AvatarOffer","Divider","Button","ButtonMinHeight","Title","Wrapper","showNotification","MainContext","useUserInfo","OfferCardItem","TextArea","Calendar","ssr","CalendarAirbnb","OfferPage","router","me","id","query","offer","setOffer","loading","setLoading","review","setReview","console","log","then","res","data","offerId","e","onChange","target","name","value","handleSendReview","text","push","shallow"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport moment from 'moment'\r\nimport Link from \"next/link\";\r\nimport Router, { useRouter } from 'next/router'\r\nimport {useAction, useAtom} from \"@reatom/react\";\r\nimport {modifyToBr} from '../../../utils/utils'\r\nimport {withReatom} from \"../../../lib/withReatom\";\r\n\r\nimport Header from \"../../../components/Header/Header\";\r\nimport {GalleryOffer} from \"../../../components/Gallery/GalleryOffer\";\r\nimport {Video} from \"../../../components/Gallery/Video\";\r\nimport {\r\n    apiGetChatById,\r\n    apiSendReview\r\n} from \"../../../actions/api\";\r\nimport {Text, LabelText} from \"../../../components/StyledComponents/Text\";\r\nimport {FlexBlock} from \"../../../components/StyledComponents/FlexBlock\";\r\nimport {AvatarOffer} from \"../../../components/Profile/styledProfileOffer\";\r\nimport {Divider} from \"../../../components/StyledComponents/Divider\";\r\nimport {Button, ButtonMinHeight} from \"../../../components/controls/Button/Button\";\r\nimport {Title} from \"../../../components/Layouts/styledLayouts\";\r\nimport {Wrapper} from \"../../../components/StyledComponents/Wrapper\";\r\nimport {showNotification} from \"../../../utils/notification\";\r\nimport {MainContext} from \"../../../components/contextProviders/MainContext\";\r\nimport useUserInfo from '../../../hooks/useUserInfo'\r\nimport OfferCardItem from \"../../../components/Offer/cards/OfferCardItem\";\r\nimport {TextArea} from \"../../../components/controls/Input/Input\";\r\n\r\nconst Calendar = dynamic(import ('../../../components/controls/Calendar/Calendar'),{ssr:false});\r\nconst CalendarAirbnb = dynamic(import ('../../../components/controls/Calendar/CalendarAirbnb'),{ssr:false});\r\n\r\nconst OfferPage = () => {\r\n    const router = useRouter()\r\n    const {me} = useContext(MainContext)\r\n    const { id } = router.query\r\n    const [offer, setOffer] = useState({})\r\n    const [loading, setLoading] = useState(false)\r\n    const [review, setReview] = useState('')\r\n\r\n    useEffect(() => {\r\n        console.log('id effect', id)\r\n        if(id) {\r\n            apiGetChatById(id)\r\n                .then(res => {\r\n                    if(res.data.offerId) setOffer(res.data.offerId)\r\n\r\n                })\r\n                .catch(e => {\r\n\r\n                })\r\n        }\r\n    }, [id]);\r\n\r\n\r\n    const onChange = (e) => {\r\n        const {name, value} = e.target\r\n        setReview(value)\r\n    }\r\n\r\n    const handleSendReview = () => {\r\n        setLoading(true)\r\n        apiSendReview(id, {text: review})\r\n            .then(res => {\r\n                setReview('')\r\n                showNotification('info', 'Review was sent successfully')\r\n                Router.push('/offers/[id]', `/offers/${offer.id}`, {shallow: true})\r\n                setLoading(false)\r\n            })\r\n            .catch(e => {\r\n                setLoading(false)\r\n            })\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            <Header isProfile/>\r\n            {offer.id ?\r\n                <>\r\n                    <Wrapper pl={18} pr={18} pb={80}>\r\n                        <Text mt={10} fz={20} >Leave review about offer</Text>\r\n\r\n                        <div className=\"review-wrapper-offer\">\r\n                            <OfferCardItem offer={offer} />\r\n                        </div>\r\n\r\n\r\n                        <div className=\"review-wrapper-form\">\r\n                            <TextArea name='review'\r\n                                      value={review}\r\n                                      onChange={onChange}\r\n                                      height={90}\r\n                                      placeholder=\"Review\"\r\n                            />\r\n\r\n                            <Button mt={20} mb={10} green loading={loading} onClick={handleSendReview} >Send review</Button>\r\n                        </div>\r\n\r\n\r\n                    </Wrapper>\r\n                </>\r\n                :\r\n                <>Loading...</>\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default withReatom(OfferPage)\r\n"]},"metadata":{},"sourceType":"module"}