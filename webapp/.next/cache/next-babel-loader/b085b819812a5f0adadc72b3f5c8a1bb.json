{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport axios from 'axios';\nimport { Provider } from 'react-redux';\nimport { createStore, declareAction, declareAtom } from '@reatom/core';\nimport { context } from '@reatom/react';\nimport App from 'next/app';\nimport { store } from '../features/index';\nexport const withReatom = (PageComponent, {\n  ssr = true\n} = {}) => {\n  const WithReatom = (_ref) => {\n    let props = _Object$assign({}, _ref);\n\n    // let store = getOrInitializeStore(store)\n    return __jsx(context.Provider, {\n      value: store\n    }, __jsx(PageComponent, props));\n  }; // Make sure people don't use this HOC on _app.js level\n\n\n  if (true) {\n    const isAppHoc = PageComponent === App || PageComponent.prototype instanceof App;\n\n    if (isAppHoc) {\n      throw new Error('The withRedux HOC only works with PageComponents');\n    }\n  } // Set the correct displayName in development\n\n\n  if (true) {\n    const displayName = PageComponent.displayName || PageComponent.name || 'Component';\n    WithReatom.displayName = `withReatom(${displayName})`;\n  }\n\n  if (ssr || PageComponent.getInitialProps) {\n    WithReatom.getInitialProps = async context => {\n      // Get or Create the store with `undefined` as initialState\n      // This allows you to set a custom default initialState\n      // Provide the store to getInitialProps of pages\n      context.reatomStore = store; // Run getInitialProps from HOCed PageComponent\n\n      const pageProps = typeof PageComponent.getInitialProps === 'function' ? await PageComponent.getInitialProps(context) : {}; // Pass props to PageComponent\n\n      return _objectSpread({}, pageProps);\n    };\n  }\n\n  return WithReatom;\n};\nlet reatomStore;\n\nconst getOrInitializeStore = initialState => {\n  // Always make a new store if server, otherwise state is shared between requests\n  if (true) {\n    return store;\n  } // Create store if unavailable on the client and set it on the window object\n\n\n  if (!reatomStore) {\n    reatomStore = store;\n  }\n\n  return store;\n};","map":{"version":3,"sources":["D:/4/диплом/webapp/lib/withReatom.js"],"names":["React","axios","Provider","createStore","declareAction","declareAtom","context","App","store","withReatom","PageComponent","ssr","WithReatom","props","isAppHoc","prototype","Error","displayName","name","getInitialProps","reatomStore","pageProps","getOrInitializeStore","initialState"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,aAAzB;AACA,SAAQC,WAAR,EAAqBC,aAArB,EAAoCC,WAApC,QAAsD,cAAtD;AACA,SAASC,OAAT,QAAwB,eAAxB;AACA,OAAOC,GAAP,MAAgB,UAAhB;AAEA,SAAQC,KAAR,QAAoB,mBAApB;AAEA,OAAO,MAAMC,UAAU,GAAG,CAACC,aAAD,EAAgB;AAAEC,EAAAA,GAAG,GAAG;AAAR,IAAiB,EAAjC,KAAwC;AAC9D,QAAMC,UAAU,GAAG,UAAiB;AAAA,QAAZC,KAAY;;AAChC;AACA,WACI,MAAC,OAAD,CAAS,QAAT;AAAkB,MAAA,KAAK,EAAEL;AAAzB,OACI,MAAC,aAAD,EAAmBK,KAAnB,CADJ,CADJ;AAKH,GAPD,CAD8D,CAU9D;;;AACA,YAA2C;AACvC,UAAMC,QAAQ,GACVJ,aAAa,KAAKH,GAAlB,IAAyBG,aAAa,CAACK,SAAd,YAAmCR,GADhE;;AAEA,QAAIO,QAAJ,EAAc;AACV,YAAM,IAAIE,KAAJ,CAAU,kDAAV,CAAN;AACH;AACJ,GAjB6D,CAmB9D;;;AACA,YAA2C;AACvC,UAAMC,WAAW,GACbP,aAAa,CAACO,WAAd,IAA6BP,aAAa,CAACQ,IAA3C,IAAmD,WADvD;AAGAN,IAAAA,UAAU,CAACK,WAAX,GAA0B,cAAaA,WAAY,GAAnD;AACH;;AAED,MAAIN,GAAG,IAAID,aAAa,CAACS,eAAzB,EAA0C;AACtCP,IAAAA,UAAU,CAACO,eAAX,GAA6B,MAAMb,OAAN,IAAiB;AAC1C;AACA;AAEA;AACAA,MAAAA,OAAO,CAACc,WAAR,GAAsBZ,KAAtB,CAL0C,CAO1C;;AACA,YAAMa,SAAS,GACX,OAAOX,aAAa,CAACS,eAArB,KAAyC,UAAzC,GACM,MAAMT,aAAa,CAACS,eAAd,CAA8Bb,OAA9B,CADZ,GAEM,EAHV,CAR0C,CAa1C;;AACA,+BACOe,SADP;AAIH,KAlBD;AAmBH;;AAED,SAAOT,UAAP;AACH,CAlDM;AAsDP,IAAIQ,WAAJ;;AACA,MAAME,oBAAoB,GAAGC,YAAY,IAAI;AACzC;AACA,YAAmC;AAC/B,WAAOf,KAAP;AACH,GAJwC,CAMzC;;;AACA,MAAI,CAACY,WAAL,EAAkB;AACdA,IAAAA,WAAW,GAAGZ,KAAd;AACH;;AAED,SAAOA,KAAP;AACH,CAZD","sourcesContent":["import React from 'react'\r\nimport axios from 'axios'\r\nimport { Provider } from 'react-redux'\r\nimport {createStore, declareAction, declareAtom} from '@reatom/core'\r\nimport { context } from '@reatom/react'\r\nimport App from 'next/app'\r\n\r\nimport {store} from '../features/index'\r\n\r\nexport const withReatom = (PageComponent, { ssr = true } = {}) => {\r\n    const WithReatom = ({...props }) => {\r\n        // let store = getOrInitializeStore(store)\r\n        return (\r\n            <context.Provider value={store}>\r\n                <PageComponent {...props} />\r\n            </context.Provider>\r\n        )\r\n    }\r\n\r\n    // Make sure people don't use this HOC on _app.js level\r\n    if (process.env.NODE_ENV !== 'production') {\r\n        const isAppHoc =\r\n            PageComponent === App || PageComponent.prototype instanceof App\r\n        if (isAppHoc) {\r\n            throw new Error('The withRedux HOC only works with PageComponents')\r\n        }\r\n    }\r\n\r\n    // Set the correct displayName in development\r\n    if (process.env.NODE_ENV !== 'production') {\r\n        const displayName =\r\n            PageComponent.displayName || PageComponent.name || 'Component'\r\n\r\n        WithReatom.displayName = `withReatom(${displayName})`\r\n    }\r\n\r\n    if (ssr || PageComponent.getInitialProps) {\r\n        WithReatom.getInitialProps = async context => {\r\n            // Get or Create the store with `undefined` as initialState\r\n            // This allows you to set a custom default initialState\r\n\r\n            // Provide the store to getInitialProps of pages\r\n            context.reatomStore = store\r\n\r\n            // Run getInitialProps from HOCed PageComponent\r\n            const pageProps =\r\n                typeof PageComponent.getInitialProps === 'function'\r\n                    ? await PageComponent.getInitialProps(context)\r\n                    : {}\r\n\r\n            // Pass props to PageComponent\r\n            return {\r\n                ...pageProps\r\n                // initialReatomState: reatomStore.getState(),\r\n            }\r\n        }\r\n    }\r\n\r\n    return WithReatom\r\n}\r\n\r\n\r\n\r\nlet reatomStore\r\nconst getOrInitializeStore = initialState => {\r\n    // Always make a new store if server, otherwise state is shared between requests\r\n    if (typeof window === 'undefined') {\r\n        return store\r\n    }\r\n\r\n    // Create store if unavailable on the client and set it on the window object\r\n    if (!reatomStore) {\r\n        reatomStore = store\r\n    }\r\n\r\n    return store\r\n}"]},"metadata":{},"sourceType":"module"}