{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nvar __jsx = React.createElement;\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  text-align: right;\\n  @media \", \" {\\n    \", \" {\\n      width: 200px;\\n    }\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  @media \", \" {\\n    display: flex;\\n\\n    \", \" {\\n      width: 20%;\\n    }\\n\\n    \", \" {\\n      width: 80%;\\n    }\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useContext } from 'react';\nimport Link from 'next/link';\nimport styled, { css } from 'styled-components';\nimport { device } from '../../lib/mediaDevice';\nimport Header from '../../components/Header/Header';\nimport { MenuEdit } from '../../components/Profile/MenuSettings';\nimport EditProfile from '../../components/Profile/EditProfile';\nimport ProfileAvatar from '../../components/Profile/ProfileAvatar';\nimport PhotosGallery from '../../components/Profile/PhotosGallery';\nimport Verification from '../../components/Profile/Verification';\nimport { SettingsWrapper } from '../../components/Profile/styledProfileHeader';\nimport { ButtonMinHeight } from '../../components/controls/Button/Button';\nimport { Divider } from '../../components/StyledComponents/Divider';\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid';\nimport { MainContext } from '../../components/contextProviders/MainContext';\nimport { withAuthSync } from '../../utils/auth';\nimport { apiEditMe, apiEditProfilePhoto, apiDeleteProfilePhoto } from '../../actions/api';\nimport { showNotification } from '../../utils/notification';\n\nvar Edit = function Edit() {\n  var _useContext = useContext(MainContext),\n      me = _useContext.me,\n      setMe = _useContext.setMe;\n\n  var _useState = useState(1),\n      tab = _useState[0],\n      setTab = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var user = _Object$assign({}, me);\n\n  var onSave = function onSave(data) {\n    setLoading(true);\n    apiEditMe(data).then(function _callee(res) {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(setMe(res.data));\n\n            case 2:\n              showNotification('info', 'profile was updated successfully');\n              setLoading(false);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    })[\"catch\"](function (e) {\n      setLoading(false);\n      showNotification('error', e);\n    });\n  };\n\n  var onSavePhoto = function onSavePhoto(blob) {\n    setLoading(true);\n    var data = new FormData();\n    data.append('avatar', blob, 'avatar.png');\n    apiEditProfilePhoto(user.id, data).then(function _callee2(res) {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(setMe(res.data));\n\n            case 2:\n              showNotification('info', 'profile photo was updated successfully');\n              setLoading(false);\n              setTab(1);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      });\n    })[\"catch\"](function (e) {\n      setLoading(false);\n      showNotification('error', e);\n    });\n  };\n\n  var onSaveGallery = function onSaveGallery(photosNew, cover) {\n    var userCopy;\n    return _regeneratorRuntime.async(function onSaveGallery$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            userCopy = _Object$assign({}, user, {\n              photos: photosNew,\n              coverPhoto: cover\n            });\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(setMe(userCopy));\n\n          case 3:\n            showNotification('info', 'profile gallery was updated successfully');\n            setLoading(false);\n\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    });\n  };\n\n  var handleDeleteAvatar = function handleDeleteAvatar() {\n    apiDeleteProfilePhoto(user.id).then(function _callee3(res) {\n      return _regeneratorRuntime.async(function _callee3$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(setMe(res.data));\n\n            case 2:\n              showNotification('info', 'profile photo was removed successfully');\n              setLoading(false);\n              setTab(1);\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      });\n    })[\"catch\"](function (e) {\n      setLoading(false);\n      showNotification('error', e);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isProfile: true\n  }), __jsx(ContainerDesktop, null, __jsx(Flex, null, __jsx(FlexLeft, null, __jsx(MenuEdit, {\n    tab: tab,\n    setTab: setTab\n  })), __jsx(FlexRight, null, __jsx(SettingsWrapper, null, __jsx(TopBtnWrapper, null, __jsx(Link, {\n    href: '/profile'\n  }, __jsx(ButtonMinHeight, {\n    transparentBlue: true,\n    black: true,\n    mt: 20\n  }, \"View profile\"))), __jsx(Divider, {\n    grey: true,\n    mt: 28,\n    mb: 22\n  }), user.id ? __jsx(React.Fragment, null, tab === 1 && __jsx(EditProfile, {\n    user: user,\n    onSave: onSave,\n    loading: loading\n  }), tab === 2 && __jsx(ProfileAvatar, {\n    user: user,\n    onSavePhoto: onSavePhoto,\n    handleDeleteAvatar: handleDeleteAvatar,\n    loading: loading\n  }), tab === 3 && __jsx(PhotosGallery, {\n    photosArr: user.photo || [],\n    coverPhoto: user.coverPhoto,\n    onSave: onSaveGallery,\n    loading: loading\n  }), tab === 4 && __jsx(Verification, {\n    user: user\n  })) : __jsx(\"div\", null, \"Loading\"))))));\n};\n\nvar FlexLeft = styled.div(_templateObject());\nvar FlexRight = styled.div(_templateObject2());\nvar Flex = styled.div(_templateObject3(), device.laptopDesktop, FlexLeft, FlexRight);\nvar TopBtnWrapper = styled.div(_templateObject4(), device.laptopDesktop, ButtonMinHeight);\nexport default withAuthSync(Edit);","map":{"version":3,"sources":["D:/4/диплом/webapp/pages/profile/edit.js"],"names":["React","useState","useContext","Link","styled","css","device","Header","MenuEdit","EditProfile","ProfileAvatar","PhotosGallery","Verification","SettingsWrapper","ButtonMinHeight","Divider","ContainerDesktop","MainContext","withAuthSync","apiEditMe","apiEditProfilePhoto","apiDeleteProfilePhoto","showNotification","Edit","me","setMe","tab","setTab","loading","setLoading","user","onSave","data","then","res","e","onSavePhoto","blob","FormData","append","id","onSaveGallery","photosNew","cover","userCopy","photos","coverPhoto","handleDeleteAvatar","photo","FlexLeft","div","FlexRight","Flex","laptopDesktop","TopBtnWrapper"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react'\r\nimport Link from 'next/link'\r\nimport styled, { css } from 'styled-components'\r\nimport { device } from '../../lib/mediaDevice'\r\nimport Header from '../../components/Header/Header'\r\nimport { MenuEdit } from '../../components/Profile/MenuSettings'\r\nimport EditProfile from '../../components/Profile/EditProfile'\r\nimport ProfileAvatar from '../../components/Profile/ProfileAvatar'\r\nimport PhotosGallery from '../../components/Profile/PhotosGallery'\r\nimport Verification from '../../components/Profile/Verification'\r\nimport { SettingsWrapper } from '../../components/Profile/styledProfileHeader'\r\nimport { ButtonMinHeight } from '../../components/controls/Button/Button'\r\nimport { Divider } from '../../components/StyledComponents/Divider'\r\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid'\r\nimport { MainContext } from '../../components/contextProviders/MainContext'\r\nimport { withAuthSync } from '../../utils/auth'\r\nimport { apiEditMe, apiEditProfilePhoto, apiDeleteProfilePhoto } from '../../actions/api'\r\nimport { showNotification } from '../../utils/notification'\r\n\r\nconst Edit = () => {\r\n  const { me, setMe } = useContext(MainContext)\r\n  const [tab, setTab] = useState(1)\r\n  const [loading, setLoading] = useState(false)\r\n\r\n  let user = Object.assign({}, me)\r\n\r\n  const onSave = (data) => {\r\n    setLoading(true)\r\n    apiEditMe(data)\r\n      .then(async (res) => {\r\n        await setMe(res.data)\r\n        showNotification('info', 'profile was updated successfully')\r\n        setLoading(false)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n        showNotification('error', e)\r\n      })\r\n  }\r\n\r\n  const onSavePhoto = (blob) => {\r\n    setLoading(true)\r\n    let data = new FormData()\r\n    data.append('avatar', blob, 'avatar.png')\r\n\r\n    apiEditProfilePhoto(user.id, data)\r\n      .then(async (res) => {\r\n        await setMe(res.data)\r\n        showNotification('info', 'profile photo was updated successfully')\r\n        setLoading(false)\r\n        setTab(1)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n        showNotification('error', e)\r\n      })\r\n  }\r\n\r\n  const onSaveGallery = async (photosNew, cover) => {\r\n    let userCopy = Object.assign({}, user, { photos: photosNew, coverPhoto: cover })\r\n    await setMe(userCopy)\r\n    showNotification('info', 'profile gallery was updated successfully')\r\n    setLoading(false)\r\n  }\r\n\r\n  const handleDeleteAvatar = () => {\r\n    apiDeleteProfilePhoto(user.id)\r\n      .then(async (res) => {\r\n        await setMe(res.data)\r\n        showNotification('info', 'profile photo was removed successfully')\r\n        setLoading(false)\r\n        setTab(1)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n        showNotification('error', e)\r\n      })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Header isProfile />\r\n\r\n      <ContainerDesktop>\r\n        <Flex>\r\n          <FlexLeft>\r\n            <MenuEdit tab={tab} setTab={setTab} />\r\n          </FlexLeft>\r\n          <FlexRight>\r\n            <SettingsWrapper>\r\n              <TopBtnWrapper>\r\n                <Link href={'/profile'}>\r\n                  <ButtonMinHeight transparentBlue black mt={20}>\r\n                    View profile\r\n                  </ButtonMinHeight>\r\n                </Link>\r\n              </TopBtnWrapper>\r\n\r\n              <Divider grey mt={28} mb={22} />\r\n\r\n              {user.id ? (\r\n                <>\r\n                  {tab === 1 && <EditProfile user={user} onSave={onSave} loading={loading} />}\r\n                  {tab === 2 && (\r\n                    <ProfileAvatar\r\n                      user={user}\r\n                      onSavePhoto={onSavePhoto}\r\n                      handleDeleteAvatar={handleDeleteAvatar}\r\n                      loading={loading}\r\n                    />\r\n                  )}\r\n                  {tab === 3 && (\r\n                    <PhotosGallery\r\n                      photosArr={user.photo || []}\r\n                      coverPhoto={user.coverPhoto}\r\n                      onSave={onSaveGallery}\r\n                      loading={loading}\r\n                    />\r\n                  )}\r\n                  {tab === 4 && <Verification user={user} />}\r\n                </>\r\n              ) : (\r\n                <div>Loading</div>\r\n              )}\r\n            </SettingsWrapper>\r\n          </FlexRight>\r\n        </Flex>\r\n      </ContainerDesktop>\r\n    </>\r\n  )\r\n}\r\n\r\nconst FlexLeft = styled.div``\r\nconst FlexRight = styled.div``\r\n\r\nconst Flex = styled.div`\r\n  @media ${device.laptopDesktop} {\r\n    display: flex;\r\n\r\n    ${FlexLeft} {\r\n      width: 20%;\r\n    }\r\n\r\n    ${FlexRight} {\r\n      width: 80%;\r\n    }\r\n  }\r\n`\r\nconst TopBtnWrapper = styled.div`\r\n  text-align: right;\r\n  @media ${device.laptopDesktop} {\r\n    ${ButtonMinHeight} {\r\n      width: 200px;\r\n    }\r\n  }\r\n`\r\n\r\nexport default withAuthSync(Edit)\r\n"]},"metadata":{},"sourceType":"module"}