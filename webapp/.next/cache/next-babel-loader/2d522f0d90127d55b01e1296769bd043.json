{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport dynamic from 'next/dynamic';\nimport moment from 'moment';\nimport Link from \"next/link\";\nimport Router, { useRouter } from 'next/router';\nimport { useAction, useAtom } from \"@reatom/react\";\nimport { modifyToBr } from '../../../utils/utils';\nimport { withReatom } from \"../../../lib/withReatom\";\nimport Header from \"../../../components/Header/Header\";\nimport { GalleryOffer } from \"../../../components/Gallery/GalleryOffer\";\nimport { Video } from \"../../../components/Gallery/Video\";\nimport { apiGetChatById, apiSendReview } from \"../../../actions/api\";\nimport { Text, LabelText } from \"../../../components/StyledComponents/Text\";\nimport { FlexBlock } from \"../../../components/StyledComponents/FlexBlock\";\nimport { AvatarOffer } from \"../../../components/Profile/styledProfileOffer\";\nimport { Divider } from \"../../../components/StyledComponents/Divider\";\nimport { Button, ButtonMinHeight } from \"../../../components/controls/Button/Button\";\nimport { Title } from \"../../../components/Layouts/styledLayouts\";\nimport { Wrapper } from \"../../../components/StyledComponents/Wrapper\";\nimport { showNotification } from \"../../../utils/notification\";\nimport { MainContext } from \"../../../components/contextProviders/MainContext\";\nimport useUserInfo from '../../../hooks/useUserInfo';\nimport OfferCardItem from \"../../../components/Offer/cards/OfferCardItem\";\nimport { TextArea } from \"../../../components/controls/Input/Input\";\nconst Calendar = dynamic(() => import('../../../components/controls/Calendar/Calendar'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('../../../components/controls/Calendar/Calendar')],\n    modules: ['../../../components/controls/Calendar/Calendar']\n  }\n});\nconst CalendarAirbnb = dynamic(() => import('../../../components/controls/Calendar/CalendarAirbnb'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('../../../components/controls/Calendar/CalendarAirbnb')],\n    modules: ['../../../components/controls/Calendar/CalendarAirbnb']\n  }\n});\n\nconst OfferPage = () => {\n  const router = useRouter();\n  const {\n    me\n  } = useContext(MainContext);\n  const {\n    id\n  } = router.query;\n  const {\n    0: offer,\n    1: setOffer\n  } = useState({});\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: review,\n    1: setReview\n  } = useState('');\n  useEffect(() => {\n    console.log('id effect', id);\n\n    if (id) {\n      apiGetChatById(id).then(res => {\n        if (res.data.offerId) setOffer(res.data.offerId);\n      }).catch(e => {});\n    }\n  }, [id]);\n\n  const onChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setReview(value);\n  };\n\n  const handleSendReview = () => {\n    setLoading(true);\n    apiSendReview(id, {\n      text: review\n    }).then(res => {\n      setReview('');\n      showNotification('info', 'Review was sent successfully');\n      Router.push('/offers/[id]', `/offers/${offer.id}`, {\n        shallow: true\n      });\n      setLoading(false);\n    }).catch(e => {\n      setLoading(false);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isProfile: true\n  }), offer.id ? __jsx(React.Fragment, null, __jsx(Wrapper, {\n    pl: 18,\n    pr: 18,\n    pb: 80\n  }, __jsx(Text, {\n    mt: 10,\n    fz: 20\n  }, \"Leave review about offer\"), __jsx(\"div\", {\n    className: \"review-wrapper-offer\"\n  }, __jsx(OfferCardItem, {\n    offer: offer\n  })), __jsx(\"div\", {\n    className: \"review-wrapper-form\"\n  }, __jsx(TextArea, {\n    name: \"review\",\n    value: review,\n    onChange: onChange,\n    height: 90,\n    placeholder: \"Review\"\n  }), __jsx(Button, {\n    mt: 20,\n    mb: 10,\n    green: true,\n    loading: loading,\n    onClick: handleSendReview\n  }, \"Send review\")))) : __jsx(React.Fragment, null, \"Loading...\"));\n};\n\nexport default withReatom(OfferPage);","map":{"version":3,"sources":["D:/4/диплом/webapp — копия/pages/booking/[id]/review.js"],"names":["React","useState","useContext","useEffect","dynamic","moment","Link","Router","useRouter","useAction","useAtom","modifyToBr","withReatom","Header","GalleryOffer","Video","apiGetChatById","apiSendReview","Text","LabelText","FlexBlock","AvatarOffer","Divider","Button","ButtonMinHeight","Title","Wrapper","showNotification","MainContext","useUserInfo","OfferCardItem","TextArea","Calendar","ssr","CalendarAirbnb","OfferPage","router","me","id","query","offer","setOffer","loading","setLoading","review","setReview","console","log","then","res","data","offerId","catch","e","onChange","name","value","target","handleSendReview","text","push","shallow"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport moment from 'moment'\r\nimport Link from \"next/link\";\r\nimport Router, { useRouter } from 'next/router'\r\nimport {useAction, useAtom} from \"@reatom/react\";\r\nimport {modifyToBr} from '../../../utils/utils'\r\nimport {withReatom} from \"../../../lib/withReatom\";\r\n\r\nimport Header from \"../../../components/Header/Header\";\r\nimport {GalleryOffer} from \"../../../components/Gallery/GalleryOffer\";\r\nimport {Video} from \"../../../components/Gallery/Video\";\r\nimport {\r\n    apiGetChatById,\r\n    apiSendReview\r\n} from \"../../../actions/api\";\r\nimport {Text, LabelText} from \"../../../components/StyledComponents/Text\";\r\nimport {FlexBlock} from \"../../../components/StyledComponents/FlexBlock\";\r\nimport {AvatarOffer} from \"../../../components/Profile/styledProfileOffer\";\r\nimport {Divider} from \"../../../components/StyledComponents/Divider\";\r\nimport {Button, ButtonMinHeight} from \"../../../components/controls/Button/Button\";\r\nimport {Title} from \"../../../components/Layouts/styledLayouts\";\r\nimport {Wrapper} from \"../../../components/StyledComponents/Wrapper\";\r\nimport {showNotification} from \"../../../utils/notification\";\r\nimport {MainContext} from \"../../../components/contextProviders/MainContext\";\r\nimport useUserInfo from '../../../hooks/useUserInfo'\r\nimport OfferCardItem from \"../../../components/Offer/cards/OfferCardItem\";\r\nimport {TextArea} from \"../../../components/controls/Input/Input\";\r\n\r\nconst Calendar = dynamic(import ('../../../components/controls/Calendar/Calendar'),{ssr:false});\r\nconst CalendarAirbnb = dynamic(import ('../../../components/controls/Calendar/CalendarAirbnb'),{ssr:false});\r\n\r\nconst OfferPage = () => {\r\n    const router = useRouter()\r\n    const {me} = useContext(MainContext)\r\n    const { id } = router.query\r\n    const [offer, setOffer] = useState({})\r\n    const [loading, setLoading] = useState(false)\r\n    const [review, setReview] = useState('')\r\n\r\n    useEffect(() => {\r\n        console.log('id effect', id)\r\n        if(id) {\r\n            apiGetChatById(id)\r\n                .then(res => {\r\n                    if(res.data.offerId) setOffer(res.data.offerId)\r\n\r\n                })\r\n                .catch(e => {\r\n\r\n                })\r\n        }\r\n    }, [id]);\r\n\r\n\r\n    const onChange = (e) => {\r\n        const {name, value} = e.target\r\n        setReview(value)\r\n    }\r\n\r\n    const handleSendReview = () => {\r\n        setLoading(true)\r\n        apiSendReview(id, {text: review})\r\n            .then(res => {\r\n                setReview('')\r\n                showNotification('info', 'Review was sent successfully')\r\n                Router.push('/offers/[id]', `/offers/${offer.id}`, {shallow: true})\r\n                setLoading(false)\r\n            })\r\n            .catch(e => {\r\n                setLoading(false)\r\n            })\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            <Header isProfile/>\r\n            {offer.id ?\r\n                <>\r\n                    <Wrapper pl={18} pr={18} pb={80}>\r\n                        <Text mt={10} fz={20} >Leave review about offer</Text>\r\n\r\n                        <div className=\"review-wrapper-offer\">\r\n                            <OfferCardItem offer={offer} />\r\n                        </div>\r\n\r\n\r\n                        <div className=\"review-wrapper-form\">\r\n                            <TextArea name='review'\r\n                                      value={review}\r\n                                      onChange={onChange}\r\n                                      height={90}\r\n                                      placeholder=\"Review\"\r\n                            />\r\n\r\n                            <Button mt={20} mb={10} green loading={loading} onClick={handleSendReview} >Send review</Button>\r\n                        </div>\r\n\r\n\r\n                    </Wrapper>\r\n                </>\r\n                :\r\n                <>Loading...</>\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default withReatom(OfferPage)\r\n"]},"metadata":{},"sourceType":"module"}