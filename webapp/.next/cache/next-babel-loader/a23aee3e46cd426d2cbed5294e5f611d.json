{"ast":null,"code":"import _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport Router from 'next/router';\nimport { apiGetMe } from '../../actions/api';\nimport cookie from \"js-cookie\";\nlet token = cookie.get('token');\nconst MainContext = React.createContext({});\nconst MainConsumer = MainContext.Consumer;\n/* Then create a provider Component */\n\nclass MainProvider extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"getMe\", () => {\n      apiGetMe().then(res => {\n        this.setState({\n          me: res.data,\n          checkedMe: true\n        });\n      }).catch(() => {\n        Router.push('/login');\n      });\n    });\n\n    _defineProperty(this, \"setMe\", me => {\n      let clone = _Object$assign({}, me);\n\n      this.setState({\n        me: me\n      });\n    });\n\n    _defineProperty(this, \"setOffer\", offer => {\n      this.setState({\n        offer: _Object$assign({}, offer)\n      });\n    });\n\n    _defineProperty(this, \"state\", {\n      me: {},\n      offer: {\n        categoryOptions: []\n      },\n      checkedMe: false,\n      setMe: this.setMe,\n      setOffer: this.setOffer,\n      listOffers: []\n    });\n  }\n\n  componentDidMount() {\n    if (token) {\n      this.getMe();\n    } else {\n      this.setState({\n        checkedMe: true\n      });\n    }\n  }\n\n  render() {\n    return __jsx(MainContext.Provider, {\n      value: this.state\n    }, this.props.children);\n  }\n\n} // MainProvider.getInitialProps = async ({ req }) => {\n//     const node_env = process.env.NODE_ENV\n//     console.log('test', node_env)\n//     const host =  req.headers.host\n//     return { node_env }\n// }\n\n\nexport default MainProvider;\nexport { MainConsumer, MainContext };","map":{"version":3,"sources":["D:/git/webapp3/webapp/components/contextProviders/MainContext.js"],"names":["React","Component","Router","apiGetMe","cookie","token","get","MainContext","createContext","MainConsumer","Consumer","MainProvider","then","res","setState","me","data","checkedMe","catch","push","clone","offer","categoryOptions","setMe","setOffer","listOffers","componentDidMount","getMe","render","state","props","children"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,SAAQC,QAAR,QAAuB,mBAAvB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,IAAIC,KAAK,GAAGD,MAAM,CAACE,GAAP,CAAW,OAAX,CAAZ;AAEA,MAAMC,WAAW,GAAGP,KAAK,CAACQ,aAAN,CAAoB,EAApB,CAApB;AACA,MAAMC,YAAY,GAAGF,WAAW,CAACG,QAAjC;AAEA;;AACA,MAAMC,YAAN,SAA2BV,SAA3B,CAAqC;AAAA;AAAA;;AAAA,mCACzB,MAAM;AACVE,MAAAA,QAAQ,GACHS,IADL,CACWC,GAAD,IAAS;AACX,aAAKC,QAAL,CAAc;AAACC,UAAAA,EAAE,EAAEF,GAAG,CAACG,IAAT;AAAeC,UAAAA,SAAS,EAAE;AAA1B,SAAd;AACH,OAHL,EAIKC,KAJL,CAIW,MAAM;AACThB,QAAAA,MAAM,CAACiB,IAAP,CAAY,QAAZ;AACH,OANL;AAQH,KAVgC;;AAAA,mCAYzBJ,EAAE,IAAI;AACV,UAAIK,KAAK,GAAG,eAAc,EAAd,EAAkBL,EAAlB,CAAZ;;AACA,WAAKD,QAAL,CAAc;AAACC,QAAAA,EAAE,EAAEA;AAAL,OAAd;AACH,KAfgC;;AAAA,sCAiBtBM,KAAK,IAAI;AAChB,WAAKP,QAAL,CAAc;AAACO,QAAAA,KAAK,EAAE,eAAc,EAAd,EAAkBA,KAAlB;AAAR,OAAd;AACH,KAnBgC;;AAAA,mCAsBzB;AACJN,MAAAA,EAAE,EAAE,EADA;AAEJM,MAAAA,KAAK,EAAE;AACHC,QAAAA,eAAe,EAAE;AADd,OAFH;AAKJL,MAAAA,SAAS,EAAE,KALP;AAMJM,MAAAA,KAAK,EAAE,KAAKA,KANR;AAOJC,MAAAA,QAAQ,EAAE,KAAKA,QAPX;AAQJC,MAAAA,UAAU,EAAE;AARR,KAtByB;AAAA;;AAiCjCC,EAAAA,iBAAiB,GAAG;AAChB,QAAGrB,KAAH,EAAU;AACN,WAAKsB,KAAL;AACH,KAFD,MAEO;AACH,WAAKb,QAAL,CAAc;AAACG,QAAAA,SAAS,EAAE;AAAZ,OAAd;AACH;AACJ;;AAIDW,EAAAA,MAAM,GAAI;AACN,WACI,MAAC,WAAD,CAAa,QAAb;AAAsB,MAAA,KAAK,EAAE,KAAKC;AAAlC,OACK,KAAKC,KAAL,CAAWC,QADhB,CADJ;AAKH;;AAjDgC,C,CAoDrC;AACA;AACA;AACA;AACA;AACA;;;AAEA,eAAepB,YAAf;AACA,SAAQF,YAAR,EAAsBF,WAAtB","sourcesContent":["import React, { Component } from 'react'\r\nimport Router from 'next/router'\r\n\r\nimport {apiGetMe} from '../../actions/api'\r\nimport cookie from \"js-cookie\";\r\nlet token = cookie.get('token')\r\n\r\nconst MainContext = React.createContext({})\r\nconst MainConsumer = MainContext.Consumer\r\n\r\n/* Then create a provider Component */\r\nclass MainProvider extends Component {\r\n    getMe = () => {\r\n        apiGetMe()\r\n            .then((res) => {\r\n                this.setState({me: res.data, checkedMe: true});\r\n            })\r\n            .catch(() => {\r\n                Router.push('/login')\r\n            });\r\n\r\n    };\r\n\r\n    setMe = me => {\r\n        let clone = Object.assign({}, me);\r\n        this.setState({me: me})\r\n    }\r\n\r\n    setOffer = offer => {\r\n        this.setState({offer: Object.assign({}, offer)})\r\n    }\r\n\r\n\r\n    state = {\r\n        me: {},\r\n        offer: {\r\n            categoryOptions: []\r\n        },\r\n        checkedMe: false,\r\n        setMe: this.setMe,\r\n        setOffer: this.setOffer,\r\n        listOffers: []\r\n    }\r\n\r\n    componentDidMount() {\r\n        if(token) {\r\n            this.getMe()\r\n        } else {\r\n            this.setState({checkedMe: true})\r\n        }\r\n    }\r\n\r\n\r\n\r\n    render () {\r\n        return (\r\n            <MainContext.Provider value={this.state} >\r\n                {this.props.children}\r\n            </MainContext.Provider>\r\n        )\r\n    }\r\n}\r\n\r\n// MainProvider.getInitialProps = async ({ req }) => {\r\n//     const node_env = process.env.NODE_ENV\r\n//     console.log('test', node_env)\r\n//     const host =  req.headers.host\r\n//     return { node_env }\r\n// }\r\n\r\nexport default MainProvider\r\nexport {MainConsumer, MainContext}\r\n\r\n"]},"metadata":{},"sourceType":"module"}