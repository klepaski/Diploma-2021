{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport Router, { useRouter } from 'next/router';\nimport dynamic from 'next/dynamic';\nimport { MainContext } from '../../../components/contextProviders/MainContext';\nimport { Wrapper, WrapperHeight } from '../../../components/StyledComponents/Wrapper';\nimport { Button, ButtonMin } from '../../../components/controls/Button/Button';\nimport { Footer, Title } from '../../../components/Layouts/styledLayouts';\nvar Calendar = dynamic(function () {\n  return import('../../../components/controls/Calendar/Calendar');\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../../../components/controls/Calendar/Calendar')];\n    },\n    modules: ['../../../components/controls/Calendar/Calendar']\n  }\n});\nimport { apiEditOffer, apiOfferUpdateDisabled } from '../../../actions/api';\nimport { Text } from '../../../components/StyledComponents/Text';\nimport Header from '../../../components/Header/Header';\nimport useOffer from '../../../hooks/useOffer';\nimport { ContainerDesktop, FooterDesktop } from '../../../components/StyledComponents/Grid';\nimport styled from 'styled-components';\nimport { device } from '../../../lib/mediaDevice';\n\nvar CalendarPage = function CalendarPage() {\n  var router = useRouter();\n  var id = router.query.id;\n  var offer = useOffer(id);\n\n  var _useContext = useContext(MainContext),\n      setOffer = _useContext.setOffer;\n\n  var _useState = useState([]),\n      selectedDays = _useState[0],\n      setSelected = _useState[1];\n\n  var _useState2 = useState(false),\n      enabledAll = _useState2[0],\n      setEnabledAll = _useState2[1];\n\n  var _useState3 = useState(false),\n      loading = _useState3[0],\n      setLoading = _useState3[1];\n\n  useEffect(function () {\n    if (offer.id) {\n      var defaultEnabledAll = offer.calendar && offer.calendar.length ? true : false;\n      console.log('offer.calendar:', offer.calendar);\n      console.log('defaultEnabledAll:', defaultEnabledAll);\n      setEnabledAll(defaultEnabledAll);\n      var calendar = offer.calendar || [];\n      var selectedArr = calendar.map(function (item) {\n        return item.date;\n      });\n      setSelected(selectedArr);\n    }\n  }, [offer.id]);\n\n  var createCalendar = function createCalendar() {\n    setLoading(true);\n    var obj = {\n      offerId: id,\n      disabledTimes: selectedDays\n    };\n    apiEditOffer(id, {\n      step: 5\n    });\n    apiOfferUpdateDisabled(obj).then(function (res) {\n      if (res.err) {\n        setLoading(false);\n        return;\n      }\n\n      setOffer(_objectSpread({}, offer, {\n        calendar: res.data\n      }));\n      Router.push('/offers/[id]/price', \"/offers/\".concat(id, \"/price\"), {\n        shallow: true\n      });\n    });\n  };\n\n  console.log('selectedDays', selectedDays);\n  console.log('offer', offer);\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isReg: true\n  }), __jsx(Wrapper, {\n    p: 17,\n    pt: 35\n  }, offer.id ? __jsx(React.Fragment, null, __jsx(ContainerDesktop, {\n    isOffer: true\n  }, __jsx(WrapperHeight, null, __jsx(Title, {\n    mb: 40\n  }, \"Update your calendar\"), __jsx(Text, {\n    fz: 18,\n    mb: 20\n  }, \"Since clients can book available days instantly, you should always keep your calendar up to date by blocking the days you can\\u2019t perform.\"), __jsx(Text, {\n    fz: 18,\n    bold: true\n  }, \"Let the clients know the dates you are availalbe below.\", ' '), __jsx(ButtonMin, {\n    transparentBlue: true,\n    mt: 20,\n    mb: 20,\n    onClick: function onClick() {\n      return setEnabledAll(true);\n    },\n    disabled: enabledAll\n  }, \"Unblock all dates\"), __jsx(Calendar, {\n    selectedDays: selectedDays,\n    setSelected: setSelected,\n    enabledAll: enabledAll,\n    endDate: offer.endDate\n  }))), __jsx(FooterDesktop, null, __jsx(Footer, {\n    mt: 30\n  }, __jsx(Button, {\n    onClick: function onClick() {\n      return Router.push('/offers/[id]/performance-details', \"/offers/\".concat(id, \"/performance-details\"), {\n        shallow: true\n      });\n    }\n  }, \"Back\"), __jsx(Button, {\n    blue: true,\n    onClick: function onClick() {\n      return createCalendar();\n    },\n    loading: loading\n  }, \"Next\")))) : __jsx(React.Fragment, null, \"Loading...\")));\n};\n\nexport default CalendarPage;","map":{"version":3,"sources":["D:/4/диплом/webapp — копия/pages/offers/[id]/calendar.js"],"names":["React","useState","useContext","useEffect","Router","useRouter","dynamic","MainContext","Wrapper","WrapperHeight","Button","ButtonMin","Footer","Title","Calendar","ssr","apiEditOffer","apiOfferUpdateDisabled","Text","Header","useOffer","ContainerDesktop","FooterDesktop","styled","device","CalendarPage","router","id","query","offer","setOffer","selectedDays","setSelected","enabledAll","setEnabledAll","loading","setLoading","defaultEnabledAll","calendar","length","console","log","selectedArr","map","item","date","createCalendar","obj","offerId","disabledTimes","step","then","res","err","data","push","shallow","endDate"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\r\nimport Router, { useRouter } from 'next/router'\r\nimport dynamic from 'next/dynamic'\r\nimport { MainContext } from '../../../components/contextProviders/MainContext'\r\n\r\nimport { Wrapper, WrapperHeight } from '../../../components/StyledComponents/Wrapper'\r\nimport { Button, ButtonMin } from '../../../components/controls/Button/Button'\r\nimport { Footer, Title } from '../../../components/Layouts/styledLayouts'\r\nconst Calendar = dynamic(import('../../../components/controls/Calendar/Calendar'), { ssr: false })\r\nimport { apiEditOffer, apiOfferUpdateDisabled } from '../../../actions/api'\r\nimport { Text } from '../../../components/StyledComponents/Text'\r\nimport Header from '../../../components/Header/Header'\r\nimport useOffer from '../../../hooks/useOffer'\r\nimport { ContainerDesktop, FooterDesktop } from '../../../components/StyledComponents/Grid'\r\nimport styled from 'styled-components'\r\nimport { device } from '../../../lib/mediaDevice'\r\n\r\nconst CalendarPage = () => {\r\n  const router = useRouter()\r\n  const { id } = router.query\r\n  const offer = useOffer(id)\r\n  const { setOffer } = useContext(MainContext)\r\n  const [selectedDays, setSelected] = useState([])\r\n  const [enabledAll, setEnabledAll] = useState(false)\r\n  const [loading, setLoading] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (offer.id) {\r\n      let defaultEnabledAll = offer.calendar && offer.calendar.length ? true : false\r\n      console.log('offer.calendar:', offer.calendar)\r\n      console.log('defaultEnabledAll:', defaultEnabledAll)\r\n      setEnabledAll(defaultEnabledAll)\r\n      let calendar = offer.calendar || []\r\n      let selectedArr = calendar.map((item) => item.date)\r\n      setSelected(selectedArr)\r\n    }\r\n  }, [offer.id])\r\n\r\n  const createCalendar = () => {\r\n    setLoading(true)\r\n    const obj = {\r\n      offerId: id,\r\n      disabledTimes: selectedDays,\r\n    }\r\n    apiEditOffer(id, { step: 5 })\r\n    apiOfferUpdateDisabled(obj).then((res) => {\r\n      if (res.err) {\r\n        setLoading(false)\r\n        return\r\n      }\r\n      setOffer({ ...offer, calendar: res.data })\r\n      Router.push('/offers/[id]/price', `/offers/${id}/price`, { shallow: true })\r\n    })\r\n  }\r\n\r\n  console.log('selectedDays', selectedDays)\r\n  console.log('offer', offer)\r\n\r\n  return (\r\n    <>\r\n      <Header isReg />\r\n      <Wrapper p={17} pt={35}>\r\n        {offer.id ? (\r\n          <>\r\n            <ContainerDesktop isOffer>\r\n              <WrapperHeight>\r\n                <Title mb={40}>Update your calendar</Title>\r\n                <Text fz={18} mb={20}>\r\n                  Since clients can book available days instantly, you should always keep your\r\n                  calendar up to date by blocking the days you can’t perform.\r\n                </Text>\r\n                <Text fz={18} bold>\r\n                  Let the clients know the dates you are availalbe below.{' '}\r\n                </Text>\r\n                <ButtonMin\r\n                    transparentBlue\r\n                    mt={20}\r\n                    mb={20}\r\n                    onClick={() => setEnabledAll(true)}\r\n                    disabled={enabledAll}\r\n                >\r\n                  Unblock all dates\r\n                </ButtonMin>\r\n\r\n                <Calendar\r\n                    selectedDays={selectedDays}\r\n                    setSelected={setSelected}\r\n                    enabledAll={enabledAll}\r\n                    endDate={offer.endDate}\r\n                />\r\n              </WrapperHeight>\r\n            </ContainerDesktop>\r\n\r\n            <FooterDesktop>\r\n              <Footer mt={30}>\r\n                <Button\r\n                    onClick={() =>\r\n                        Router.push(\r\n                            '/offers/[id]/performance-details',\r\n                            `/offers/${id}/performance-details`,\r\n                            { shallow: true },\r\n                        )\r\n                    }\r\n                >\r\n                  Back\r\n                </Button>\r\n                <Button blue onClick={() => createCalendar()} loading={loading}>\r\n                  Next\r\n                </Button>\r\n              </Footer>\r\n            </FooterDesktop>\r\n\r\n          </>\r\n        ) : (\r\n          <>Loading...</>\r\n        )}\r\n      </Wrapper>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default CalendarPage\r\n\r\n"]},"metadata":{},"sourceType":"module"}