{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nvar __jsx = React.createElement;\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  \", \" {\\n    text-align: center;\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  \", \" {\\n    cursor: pointer;\\n  }\\n  \", \" {\\n    cursor: pointer;\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  @media \", \" {\\n    display: flex;\\n    flex-wrap: wrap;\\n    justify-content: space-between;\\n\\n    > div {\\n      width: 30%;\\n      min-height: 350px;\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport Router from 'next/router';\nimport { Title, Footer, Label2 } from '../../components/Layouts/styledLayouts';\nimport styled, { css } from 'styled-components';\nimport { device } from '../../lib/mediaDevice';\nimport { Wrapper, WrapperHeight } from '../../components/StyledComponents/Wrapper';\nimport { Button, ButtonMin } from '../../components/controls/Button/Button';\nimport Header from '../../components/Header/Header';\nimport { Text } from '../../components/StyledComponents/Text';\nimport { FlexBlock } from '../../components/StyledComponents/FlexBlock';\nimport { apiEditOffer, apiGetListUserOffers } from '../../actions/api';\nimport { MainContext } from '../../components/contextProviders/MainContext';\nimport OfferCardItemBig from '../../components/Offer/cards/OfferCardItemBig';\nimport { showNotification } from '../../utils/notification';\nimport { PlusPurple, Preferences } from '../../components/StyledComponents/Icon';\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid';\n\nvar ProfileOffers = function ProfileOffers() {\n  var _useContext = useContext(MainContext),\n      me = _useContext.me,\n      listOffers = _useContext.listOffers;\n\n  var _useState = useState(listOffers),\n      list = _useState[0],\n      setList = _useState[1];\n\n  var _useState2 = useState(true),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      isPublishing = _useState3[0],\n      setIsPublishing = _useState3[1];\n\n  useEffect(function () {\n    if (me.id) getListOffers();\n  }, [me.id]);\n\n  var getListOffers = function getListOffers() {\n    setLoading(true);\n    apiGetListUserOffers(me.id).then(function (res) {\n      setList(res.data);\n      setLoading(false);\n    })[\"catch\"](function (e) {\n      setLoading(false);\n    });\n  };\n\n  var handlePublishOffer = function handlePublishOffer(id) {\n    var data = {\n      status: 'open'\n    };\n    setIsPublishing(true);\n    apiEditOffer(id, data).then(function (res) {\n      var clone = _toConsumableArray(list);\n\n      var index = clone.findIndex(function (x) {\n        return x.id === id;\n      });\n      clone[index] = res.data;\n      setList(clone);\n      showNotification('info', 'Offer was published successfully');\n      setIsPublishing(false);\n    })[\"catch\"](function (e) {\n      showNotification('error', e);\n      setIsPublishing(false);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    isProfile: true\n  }), __jsx(Wrapper, {\n    p: 15\n  }, __jsx(ContainerDesktop, null, __jsx(FlexBlock, {\n    mb: 30\n  }, __jsx(Text, {\n    fz: 18,\n    pt: '5px'\n  }, \"Listing\"), __jsx(Box, null, list.length ? __jsx(React.Fragment, null, __jsx(Preferences, null), __jsx(PlusPurple, {\n    ml: 30,\n    onClick: function onClick() {\n      return Router.push('/offers/create');\n    }\n  })) : __jsx(Button, {\n    transparentPurple: true,\n    onClick: function onClick() {\n      Router.push('/offers/create');\n    }\n  }, \"Create an offer\"))), loading && __jsx(\"div\", null, \"Loading... \"), list.length ? __jsx(WrapOffers, null, list.map(function (offer, key) {\n    return __jsx(OfferCardItemBig, {\n      key: offer.id,\n      offer: offer,\n      handlePublishOffer: handlePublishOffer,\n      isPublishing: isPublishing\n    });\n  })) : __jsx(Center, null, !loading && __jsx(Title, null, \"You have no offers yet\")))));\n};\n\nexport default ProfileOffers;\nvar WrapOffers = styled.div(_templateObject(), device.laptopDesktop);\nvar Box = styled.div(_templateObject2(), Preferences, PlusPurple);\nvar Center = styled.div(_templateObject3(), Title);","map":{"version":3,"sources":["D:/4/диплом/webapp/pages/profile/offers.js"],"names":["React","useState","useContext","useEffect","Router","Title","Footer","Label2","styled","css","device","Wrapper","WrapperHeight","Button","ButtonMin","Header","Text","FlexBlock","apiEditOffer","apiGetListUserOffers","MainContext","OfferCardItemBig","showNotification","PlusPurple","Preferences","ContainerDesktop","ProfileOffers","me","listOffers","list","setList","loading","setLoading","isPublishing","setIsPublishing","id","getListOffers","then","res","data","e","handlePublishOffer","status","clone","index","findIndex","x","length","push","map","offer","key","WrapOffers","div","laptopDesktop","Box","Center"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\r\nimport Router from 'next/router'\r\nimport { Title, Footer, Label2 } from '../../components/Layouts/styledLayouts'\r\nimport styled, { css } from 'styled-components'\r\nimport { device } from '../../lib/mediaDevice'\r\nimport { Wrapper, WrapperHeight } from '../../components/StyledComponents/Wrapper'\r\nimport { Button, ButtonMin } from '../../components/controls/Button/Button'\r\nimport Header from '../../components/Header/Header'\r\nimport { Text } from '../../components/StyledComponents/Text'\r\nimport { FlexBlock } from '../../components/StyledComponents/FlexBlock'\r\nimport { apiEditOffer, apiGetListUserOffers } from '../../actions/api'\r\nimport { MainContext } from '../../components/contextProviders/MainContext'\r\nimport OfferCardItemBig from '../../components/Offer/cards/OfferCardItemBig'\r\nimport { showNotification } from '../../utils/notification'\r\nimport { PlusPurple, Preferences } from '../../components/StyledComponents/Icon'\r\nimport { ContainerDesktop } from '../../components/StyledComponents/Grid'\r\n\r\nconst ProfileOffers = () => {\r\n  const { me, listOffers } = useContext(MainContext)\r\n  const [list, setList] = useState(listOffers)\r\n  const [loading, setLoading] = useState(true)\r\n  const [isPublishing, setIsPublishing] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (me.id) getListOffers()\r\n  }, [me.id])\r\n\r\n  const getListOffers = () => {\r\n    setLoading(true)\r\n    apiGetListUserOffers(me.id)\r\n      .then((res) => {\r\n        setList(res.data)\r\n        setLoading(false)\r\n      })\r\n      .catch((e) => {\r\n        setLoading(false)\r\n      })\r\n  }\r\n\r\n  const handlePublishOffer = (id) => {\r\n    let data = {\r\n      status: 'open',\r\n    }\r\n    setIsPublishing(true)\r\n    apiEditOffer(id, data)\r\n      .then((res) => {\r\n        let clone = [...list]\r\n        let index = clone.findIndex((x) => x.id === id)\r\n        clone[index] = res.data\r\n        setList(clone)\r\n        showNotification('info', 'Offer was published successfully')\r\n        setIsPublishing(false)\r\n      })\r\n      .catch((e) => {\r\n        showNotification('error', e)\r\n        setIsPublishing(false)\r\n      })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Header isProfile />\r\n      <Wrapper p={15}>\r\n        <ContainerDesktop>\r\n          <FlexBlock mb={30}>\r\n            <Text fz={18} pt={'5px'}>\r\n              Listing\r\n            </Text>\r\n            <Box>\r\n              {list.length ? (\r\n                <>\r\n                  <Preferences />\r\n                  <PlusPurple ml={30} onClick={() => Router.push('/offers/create')} />\r\n                </>\r\n              ) : (\r\n                <Button\r\n                  transparentPurple\r\n                  onClick={() => {\r\n                    Router.push('/offers/create')\r\n                  }}\r\n                >\r\n                  Create an offer\r\n                </Button>\r\n              )}\r\n            </Box>\r\n          </FlexBlock>\r\n\r\n          {loading && <div>Loading... </div>}\r\n\r\n          {list.length ? (\r\n            <WrapOffers>\r\n              {list.map((offer, key) => (\r\n                <OfferCardItemBig\r\n                  key={offer.id}\r\n                  offer={offer}\r\n                  handlePublishOffer={handlePublishOffer}\r\n                  isPublishing={isPublishing}\r\n                />\r\n              ))}\r\n            </WrapOffers>\r\n          ) : (\r\n            <Center>{!loading && <Title>You have no offers yet</Title>}</Center>\r\n          )}\r\n        </ContainerDesktop>\r\n      </Wrapper>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ProfileOffers\r\n\r\nconst WrapOffers = styled.div`\r\n  @media ${device.laptopDesktop} {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: space-between;\r\n\r\n    > div {\r\n      width: 30%;\r\n      min-height: 350px;\r\n    }\r\n  }\r\n`\r\nconst Box = styled.div`\r\n  ${Preferences} {\r\n    cursor: pointer;\r\n  }\r\n  ${PlusPurple} {\r\n    cursor: pointer;\r\n  }\r\n`\r\nconst Center = styled.div`\r\n  ${Title} {\r\n    text-align: center;\r\n  }\r\n`\r\n"]},"metadata":{},"sourceType":"module"}